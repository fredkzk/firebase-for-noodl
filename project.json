{"name":"Firebase","components":[{"name":"/Firebase/App","graph":{"connections":[{"fromId":"246f9453-a119-ac78-171e-3806cf596ecc","fromProperty":"didMount","toId":"50dfc8ce-7a08-9adb-1c3b-e7c072cb2a17","toProperty":"Do"},{"fromId":"50dfc8ce-7a08-9adb-1c3b-e7c072cb2a17","fromProperty":"Success","toId":"6ff16834-ca6b-1c76-0474-b60bc04b2dfa","toProperty":"Do"}],"roots":[{"id":"246f9453-a119-ac78-171e-3806cf596ecc","type":"Group","x":-111.4681915301291,"y":311.4376377651178,"parameters":{"backgroundColor":"#FFFFFF","minHeight":{"value":100,"unit":"vh"}},"ports":[],"dynamicports":[],"children":[{"id":"a24a02ae-c1b8-1250-72c3-a1d48cbc9558","type":"Router","parameters":{"name":"Firebase Main","pages":{"routes":["/Firebase/Start Page","/Firebase/User Auth/SignUp-SignIn with Firebase Eml & Pwd","/Firebase/Password Reset/Reset Firebase Password","/Firebase/Verify & Update Email/Update Firebase Email","/Firebase/User Auth/Sign-out","/Firebase/Delete Account/Delete Account"],"startPage":"/Firebase/Start Page"}},"ports":[],"dynamicports":[],"children":[]}]},{"id":"50dfc8ce-7a08-9adb-1c3b-e7c072cb2a17","type":"/Firebase/Firebase_init - Setup Client","x":-353.6348581967958,"y":343.4376377651178,"parameters":{"apiKey":"AIzaSyCaPVTsEYQzmx00TqV09oyqEVfPkMyim9E","authDomain":"uscape-219cc.firebaseapp.com","projectId":"uscape-219cc","storageBucket":"uscape-219cc.appspot.com","messagingSenderId":"83616129510","appId":"1:83616129510:web:d2a294cc5670da40b83627"},"ports":[],"dynamicports":[],"children":[]},{"id":"6ff16834-ca6b-1c76-0474-b60bc04b2dfa","type":"/Firebase/Firebase - Get Current User","x":-571.5515248634624,"y":354.6043044317845,"parameters":{},"ports":[],"dynamicports":[],"children":[]}],"visualRoots":["246f9453-a119-ac78-171e-3806cf596ecc"]},"metadata":{"canvasSize":{"width":"1039px","height":"751px"},"canvasPos":{"x":0,"y":0}}},{"name":"/Firebase/Delete Account/Confirm Delete Popup","id":"33f767de-e64d-b101-f9cc-f9ead7303b76","graph":{"connections":[{"fromId":"c78c6c7f-f401-2e53-1a86-946fa33a065f","fromProperty":"formatted","toId":"a5096f00-5c30-996e-908c-c573cdbc9e4d","toProperty":"text"},{"fromId":"bc4f387b-3371-a1b3-0dd7-5b27e129525f","fromProperty":"prop-email","toId":"c78c6c7f-f401-2e53-1a86-946fa33a065f","toProperty":"email"},{"fromId":"106ed29a-e2d4-9806-4ed6-cfd75844131e","fromProperty":"onClick","toId":"1a7979e9-e1b6-a1ae-cb7a-ce594e43e255","toProperty":"closeAction-User Confirmed"},{"fromId":"d6e98109-cf5c-5638-7e71-d8cae9a7cae0","fromProperty":"onClick","toId":"1a7979e9-e1b6-a1ae-cb7a-ce594e43e255","toProperty":"closeAction-User Cancelled"}],"roots":[{"id":"67c590cc-9314-8ac2-abaf-ad5d5fc94ca3","type":"Group","x":0,"y":0,"parameters":{"alignX":"center","alignItems":"center","paddingTop":{"value":16,"unit":"px"},"backgroundColor":"White"},"ports":[],"dynamicports":[],"children":[{"id":"a5096f00-5c30-996e-908c-c573cdbc9e4d","type":"Text","parameters":{"text":"","textAlignX":"center","marginBottom":{"value":16,"unit":"px"}},"ports":[],"dynamicports":[],"children":[]},{"id":"480bc785-6586-6eb8-8f87-d85ac979b469","type":"Group","parameters":{"flexDirection":"row","justifyContent":"space-evenly"},"ports":[],"dynamicports":[],"children":[{"id":"106ed29a-e2d4-9806-4ed6-cfd75844131e","type":"net.noodl.controls.button","parameters":{"label":"Confirm","marginTop":{"value":0,"unit":"px"}},"ports":[],"dynamicports":[],"children":[]},{"id":"d6e98109-cf5c-5638-7e71-d8cae9a7cae0","type":"net.noodl.controls.button","parameters":{"label":"Cancel"},"ports":[],"dynamicports":[],"children":[]}]}]},{"id":"c78c6c7f-f401-2e53-1a86-946fa33a065f","type":"String Format","x":-191.83333333333337,"y":31.833333333333314,"parameters":{"format":"You are about to delete the account associated to {email}.\nThis action is irreversible, please confirm."},"ports":[],"dynamicports":[{"name":"email","type":"string","plug":"input","index":2}],"children":[]},{"id":"bc4f387b-3371-a1b3-0dd7-5b27e129525f","type":"Model2","x":-421.58333333333337,"y":15.583333333333314,"parameters":{"modelId":"currentUser","properties":"email"},"ports":[],"dynamicports":[{"type":{"name":"*","allowConnectionsOnly":true},"plug":"input/output","group":"Properties","name":"prop-email","displayName":"email","index":7},{"type":"signal","plug":"output","group":"Changed Events","displayName":"email Changed","name":"changed-email","index":8}],"children":[]},{"id":"1a7979e9-e1b6-a1ae-cb7a-ce594e43e255","type":"NavigationClosePopup","x":297.52083333333326,"y":216.47916666666666,"parameters":{"closeActions":"User Confirmed,User Cancelled"},"ports":[],"dynamicports":[{"type":"signal","plug":"input","group":"Close Actions","name":"closeAction-User Confirmed","displayName":"User Confirmed","index":3},{"type":"signal","plug":"input","group":"Close Actions","name":"closeAction-User Cancelled","displayName":"User Cancelled","index":4}],"children":[]}],"visualRoots":["67c590cc-9314-8ac2-abaf-ad5d5fc94ca3"]}},{"name":"/Firebase/Delete Account/Delete Account","id":"dc13f9de-218c-e2b5-bb36-abcdc92944b8","graph":{"connections":[{"fromId":"9977d53b-c465-5fb0-9f5b-22b90b0a8c7e","fromProperty":"Success","toId":"bf0ca3a3-3d95-4c52-d24b-1f795639298c","toProperty":"navigate"},{"fromId":"7c4509c5-800a-c49d-59c5-881427db7979","fromProperty":"onTextChanged","toId":"b7d93e84-110a-8058-8252-fbbd908d108b","toProperty":"in-email"},{"fromId":"70a8fab9-f741-7353-42a5-4e25ee9f147a","fromProperty":"onTextChanged","toId":"b7d93e84-110a-8058-8252-fbbd908d108b","toProperty":"in-password"},{"fromId":"edfda6fc-bd1b-c7cf-6550-971e73f9ce5a","fromProperty":"onClick","toId":"b7d93e84-110a-8058-8252-fbbd908d108b","toProperty":"run"},{"fromId":"9977d53b-c465-5fb0-9f5b-22b90b0a8c7e","fromProperty":"isReauthRequired","toId":"04076ef8-8ea1-283b-b651-929b05428770","toProperty":"mounted"},{"fromId":"b7d93e84-110a-8058-8252-fbbd908d108b","fromProperty":"out-Success","toId":"9977d53b-c465-5fb0-9f5b-22b90b0a8c7e","toProperty":"Do"},{"fromId":"9977d53b-c465-5fb0-9f5b-22b90b0a8c7e","fromProperty":"isReauthRequired","toId":"dbd8e9d9-136b-38f6-67db-fc59d6f4a016","toProperty":"value"},{"fromId":"dbd8e9d9-136b-38f6-67db-fc59d6f4a016","fromProperty":"result","toId":"5f001e4c-dbd6-ba7a-df6c-8e7e09b4b4bb","toProperty":"mounted"},{"fromId":"5f001e4c-dbd6-ba7a-df6c-8e7e09b4b4bb","fromProperty":"onClick","toId":"561d7cb9-a49d-2823-06b6-62974c3dd99e","toProperty":"show"},{"fromId":"561d7cb9-a49d-2823-06b6-62974c3dd99e","fromProperty":"closeAction-User Confirmed","toId":"9977d53b-c465-5fb0-9f5b-22b90b0a8c7e","toProperty":"Do"},{"fromId":"561d7cb9-a49d-2823-06b6-62974c3dd99e","fromProperty":"closeAction-User Cancelled","toId":"bf0ca3a3-3d95-4c52-d24b-1f795639298c","toProperty":"navigate"}],"roots":[{"id":"ffee13f2-7fc5-c349-0bb5-fef67d776fb1","type":"Page","x":0,"y":0,"parameters":{},"ports":[],"dynamicports":[{"name":"title","displayName":"Title","type":"string","group":"General","plug":"input","default":"Delete Account","index":31},{"name":"urlPath","displayName":"Url Path","type":"string","group":"General","plug":"input","default":"delete-account","index":32}],"children":[{"id":"39d13239-b39a-d166-fde8-e9816f69e2db","type":"Group","parameters":{"marginTop":{"value":24,"unit":"px"},"marginLeft":{"value":24,"unit":"px"}},"ports":[],"dynamicports":[],"children":[{"id":"5f001e4c-dbd6-ba7a-df6c-8e7e09b4b4bb","type":"net.noodl.controls.button","parameters":{"label":"Delete account"},"ports":[],"dynamicports":[],"children":[]}]},{"id":"04076ef8-8ea1-283b-b651-929b05428770","type":"Group","label":"Eml-pwd inputs","parameters":{"mounted":false},"ports":[],"dynamicports":[],"children":[{"id":"a091ceeb-5c6a-f16f-ac1c-64bf2c2cccc5","type":"Text","label":"Alert text","parameters":{"text":"This action requires reauthentication","color":"Danger"},"ports":[],"dynamicports":[],"children":[]},{"id":"7c4509c5-800a-c49d-59c5-881427db7979","type":"net.noodl.controls.textinput","label":"Email Input","parameters":{"label":"","type":"email","placeholder":"Email","marginBottom":{"value":8,"unit":"px"},"useLabel":false,"mounted":true},"ports":[],"dynamicports":[],"children":[]},{"id":"70a8fab9-f741-7353-42a5-4e25ee9f147a","type":"net.noodl.controls.textinput","label":"Password Input","parameters":{"placeholder":"Password","useLabel":false,"mounted":true},"ports":[],"dynamicports":[],"children":[]},{"id":"edfda6fc-bd1b-c7cf-6550-971e73f9ce5a","type":"net.noodl.controls.button","parameters":{"label":"Authenticate","mounted":true},"ports":[],"dynamicports":[],"children":[]}]}]},{"id":"1f7b1345-2185-4db5-7cc0-40d9eb0a4762","type":"PageInputs","x":-100,"y":-50,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"9977d53b-c465-5fb0-9f5b-22b90b0a8c7e","type":"/Firebase/Delete Account/Firebase - User Delete","x":594,"y":278,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"bf0ca3a3-3d95-4c52-d24b-1f795639298c","type":"RouterNavigate","x":837,"y":177.00000000000003,"parameters":{"router":"Firebase Main","target":"/Firebase/User Auth/SignUp-SignIn with Firebase Eml & Pwd"},"ports":[],"dynamicports":[{"plug":"input","type":{"name":"enum","enums":[{"label":"Supabase Not Logged In Router","value":"Supabase Not Logged In Router"},{"label":"Supabase Logged In Router","value":"Supabase Logged In Router"},{"label":"Firebase Main","value":"Firebase Main"}],"allowEditOnly":true},"group":"General","displayName":"Router","name":"router","index":3},{"plug":"input","type":{"name":"component","title":"Choose page component","components":["/Firebase/Start Page","/Firebase/User Auth/SignUp-SignIn with Firebase Eml & Pwd","/Firebase/Password Reset/Reset Firebase Password","/Firebase/Verify & Update Email/Update Firebase Email","/Firebase/User Auth/Sign-out","/Firebase/Delete Account/Delete Account"],"allowEditOnly":true},"group":"General","displayName":"Target Page","name":"target","index":4}],"children":[]},{"id":"b7d93e84-110a-8058-8252-fbbd908d108b","type":"JavaScriptFunction","label":"reauthenticateWithCredential","x":322,"y":370,"parameters":{"functionScript":"if (!Boolean(Noodl.Variables.firebaseAuth)) {\r\n    console.error(\"Firebase Auth is not configured!\");\r\n    Outputs.Failure();\r\n    return; // Stops the function if Firebase Auth is not initialized\r\n}\r\n\r\nconst user = Noodl.Variables.firebaseAuth.currentUser;\r\nconst email = Inputs.email; // Assume email and password are provided through Noodl Inputs\r\nconst password = Inputs.password;\r\nconst credential = window.EmailAuthProvider.credential(email, password);\r\n\r\n// Re-authenticate user\r\nwindow.reauthenticateWithCredential(user, credential)\r\n    .then(() => {\r\n        console.log(\"User re-authenticated.\");\r\n        Outputs.Success();\r\n    })\r\n    .catch((error) => {\r\n        console.error(\"Error re-authenticating user: \", error);\r\n        switch (error.code) {\r\n            case \"auth/user-mismatch\":\r\n                Outputs.error = \"The provided credentials do not match the logged-in user.\";\r\n                break;\r\n            case \"auth/user-not-found\":\r\n                Outputs.error = \"No user corresponding to the provided credentials could be found.\";\r\n                break;\r\n            case \"auth/invalid-credential\":\r\n                Outputs.error = \"The provided credential is invalid.\";\r\n                break;\r\n            case \"auth/invalid-email\":\r\n                Outputs.error = \"The email address is not valid.\";\r\n                break;\r\n            case \"auth/wrong-password\":\r\n                Outputs.error = \"Wrong password.\";\r\n                break;\r\n            default:\r\n                Outputs.error = \"An error occurred during re-authentication.\";\r\n        }\r\n        Outputs.Failure();\r\n    });"},"ports":[],"dynamicports":[{"name":"in-email","displayName":"email","plug":"input","type":"*","group":"Inputs","index":4},{"name":"in-password","displayName":"password","plug":"input","type":"*","group":"Inputs","index":5},{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":6},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":7},{"name":"out-error","displayName":"error","plug":"output","type":"*","group":"Outputs","index":8}],"children":[],"metadata":{"merge":{"soureCodePorts":["functionScript"]}}},{"id":"dbd8e9d9-136b-38f6-67db-fc59d6f4a016","type":"Inverter","x":315,"y":225,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"561d7cb9-a49d-2823-06b6-62974c3dd99e","type":"NavigationShowPopup","x":314.25,"y":102.79166666666669,"parameters":{"target":"/Firebase/Delete Account/Confirm Delete Popup"},"ports":[],"dynamicports":[{"name":"closeAction-User Confirmed","displayName":"User Confirmed","type":"signal","plug":"output","group":"Close Actions","index":3},{"name":"closeAction-User Cancelled","displayName":"User Cancelled","type":"signal","plug":"output","group":"Close Actions","index":4}],"children":[]}],"visualRoots":["ffee13f2-7fc5-c349-0bb5-fef67d776fb1"]}},{"name":"/Firebase/Delete Account/Firebase - User Delete","id":"f2c45ac9-a1ca-e8dc-4c97-e741d178d51b","graph":{"connections":[{"fromId":"4da46812-5ad1-cd20-d2ec-682ff2205feb","fromProperty":"Do","toId":"a91eb982-83ac-8601-7c5e-b23f6d53c1c3","toProperty":"run"},{"fromId":"a91eb982-83ac-8601-7c5e-b23f6d53c1c3","fromProperty":"out-Success","toId":"e42252e6-ca0f-5c1d-6949-d8add025823a","toProperty":"Success"},{"fromId":"a91eb982-83ac-8601-7c5e-b23f6d53c1c3","fromProperty":"out-Failure","toId":"e42252e6-ca0f-5c1d-6949-d8add025823a","toProperty":"Failure"},{"fromId":"a91eb982-83ac-8601-7c5e-b23f6d53c1c3","fromProperty":"out-isReauthRequired","toId":"e42252e6-ca0f-5c1d-6949-d8add025823a","toProperty":"isReauthRequired"}],"roots":[{"id":"4da46812-5ad1-cd20-d2ec-682ff2205feb","type":"Component Inputs","x":-63,"y":-38,"parameters":{},"ports":[{"name":"Do","plug":"output","type":"*","index":0}],"dynamicports":[],"children":[]},{"id":"e42252e6-ca0f-5c1d-6949-d8add025823a","type":"Component Outputs","x":339,"y":-47,"parameters":{},"ports":[{"name":"Success","plug":"input","type":"*","index":0},{"name":"Failure","plug":"input","type":"*","index":1},{"name":"isReauthRequired","plug":"input","type":{"name":"*"},"index":2}],"dynamicports":[],"children":[]},{"id":"a91eb982-83ac-8601-7c5e-b23f6d53c1c3","type":"JavaScriptFunction","label":"Delete user","x":141,"y":-51,"parameters":{"functionScript":"const user = Noodl.Variables.firebaseAuth.currentUser;\r\n\r\nif (user) {\r\n  user.delete().then(() => {\r\n    console.log(\"User account deleted successfully.\");\r\n    Noodl.Objects.currentUser = null; // Empty the currentUser object upon successful deletion\r\n    Outputs.Success();\r\n  }).catch((error) => {\r\n    console.error(\"Error deleting user account:\", error);\r\n    if (error.code === \"auth/requires-recent-login\") {\r\n      console.error(\"User re-authentication required.\");\r\n      Outputs.isReauthRequired = true; // Signal to the UI that re-authentication is required\r\n      Outputs.Failure(); // Optionally, you might want to call Failure here or handle it differently\r\n    } else {\r\n      Outputs.error = \"Failed to delete user account.\";\r\n      Outputs.Failure();\r\n    }\r\n  });\r\n} else {\r\n  console.error(\"No user is currently signed in.\");\r\n  Outputs.error = \"No user is currently signed in.\";\r\n  Outputs.Failure();\r\n}"},"ports":[],"dynamicports":[{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":4},{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":5},{"name":"out-isReauthRequired","displayName":"isReauthRequired","plug":"output","type":"*","group":"Outputs","index":6},{"name":"out-error","displayName":"error","plug":"output","type":"*","group":"Outputs","index":7}],"children":[],"metadata":{"merge":{"soureCodePorts":["functionScript"]}}}],"visualRoots":[]}},{"name":"/Firebase/Email Verification/Firebase - Send Email Verification","id":"bdd1ad8b-5213-a84d-aef5-1ab156b71cb7","graph":{"connections":[{"fromId":"b8ccf245-1af3-dc3f-4426-889c58c278c9","fromProperty":"Do","toId":"ffda7497-6c8c-52c9-32f5-3c5146428b82","toProperty":"run"},{"fromId":"ffda7497-6c8c-52c9-32f5-3c5146428b82","fromProperty":"out-Failure","toId":"8eb6acd7-0e12-9be4-00e1-421aba59176a","toProperty":"Failure"},{"fromId":"ffda7497-6c8c-52c9-32f5-3c5146428b82","fromProperty":"out-Success","toId":"8eb6acd7-0e12-9be4-00e1-421aba59176a","toProperty":"Success"},{"fromId":"ffda7497-6c8c-52c9-32f5-3c5146428b82","fromProperty":"out-error","toId":"8eb6acd7-0e12-9be4-00e1-421aba59176a","toProperty":"Error"}],"roots":[{"id":"b8ccf245-1af3-dc3f-4426-889c58c278c9","type":"Component Inputs","x":-114,"y":-75,"parameters":{},"ports":[{"name":"Do","plug":"output","type":"*","index":0}],"dynamicports":[],"children":[]},{"id":"8eb6acd7-0e12-9be4-00e1-421aba59176a","type":"Component Outputs","x":336,"y":-69,"parameters":{},"ports":[{"name":"Success","plug":"input","type":"*","index":0},{"name":"Failure","plug":"input","type":"*","index":1},{"name":"Error","plug":"input","type":{"name":"*"},"index":2}],"dynamicports":[],"children":[]},{"id":"ffda7497-6c8c-52c9-32f5-3c5146428b82","type":"JavaScriptFunction","label":"sendEmailVerification","x":105.66666666666663,"y":-91,"parameters":{"functionScript":"if (!Boolean(Noodl.Variables.firebaseAuth)) {\r\n    console.error(\"Firebase Auth is not configured!\");\r\n    return; // Stops the function if Firebase Auth servie is not initialized\r\n}\r\n\r\n// Use the Firebase Auth Variables to access the current user\r\nconst user = Noodl.Variables.firebaseAuth.currentUser;\r\n\r\nif (user) {\r\n    // Call sendEmailVerification for the current user\r\n    window.sendEmailVerification(user)\r\n        .then(() => {\r\n            console.log(\"Verification email sent.\");\r\n            Outputs.Success();\r\n        })\r\n        .catch((error) => {\r\n            console.error(\"Error sending email verification: \", error);\r\n            // Handle specific errors with Outputs.error\r\n            switch (error.code) {\r\n                case \"auth/invalid-user-token\":\r\n                    Outputs.error = \"Invalid user token\";\r\n                    break;\r\n                case \"auth/user-disabled\":\r\n                    Outputs.error = \"User disabled\";\r\n                    break;\r\n                default:\r\n                    Outputs.error = \"Email verification send failed\";\r\n            }\r\n            Outputs.Failure();\r\n        });\r\n} else {\r\n    console.log(\"No signed-in user to send verification to.\");\r\n    Outputs.error = \"No signed-in user\";\r\n    Outputs.Failure();\r\n}"},"ports":[],"dynamicports":[{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":4},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":5},{"name":"out-error","displayName":"error","plug":"output","type":"*","group":"Outputs","index":6}],"children":[],"metadata":{"merge":{"soureCodePorts":["functionScript"]}}}],"visualRoots":[]}},{"name":"/Firebase/Email Verification/Firebase - Sent Email Verif Popup","id":"40b1b334-412e-8946-da23-4be927bb1ac0","graph":{"connections":[{"fromId":"8067ca8c-5c20-1469-972c-0bf80d66a985","fromProperty":"prop-providerData","toId":"e8bb195c-4eb9-da94-da32-4b11cb9480f5","toProperty":"providerData"},{"fromId":"40e6767d-902c-4f3b-c9f5-a3332af79bbd","fromProperty":"formatted","toId":"a1378d19-2a11-2758-c91b-f14c6241c2bb","toProperty":"text"},{"fromId":"e8bb195c-4eb9-da94-da32-4b11cb9480f5","fromProperty":"result","toId":"40e6767d-902c-4f3b-c9f5-a3332af79bbd","toProperty":"userEmail"}],"roots":[{"id":"8067ca8c-5c20-1469-972c-0bf80d66a985","type":"Model2","x":-828.3333333333335,"y":25,"parameters":{"modelId":"currentUser","properties":"providerData"},"ports":[],"dynamicports":[{"type":{"name":"*","allowConnectionsOnly":true},"plug":"input/output","group":"Properties","name":"prop-providerData","displayName":"providerData","index":7},{"type":"signal","plug":"output","group":"Changed Events","displayName":"providerData Changed","name":"changed-providerData","index":8}],"children":[]},{"id":"e8bb195c-4eb9-da94-da32-4b11cb9480f5","type":"Expression","x":-596.8819444444443,"y":-4.854166666666686,"parameters":{"expression":"providerData[0].email"},"ports":[],"dynamicports":[{"group":"Parameters","name":"providerData","type":{"name":"*","editAsType":"string"},"plug":"input","index":7},{"group":"Parameters","name":"email","type":{"name":"*","editAsType":"string"},"plug":"input","index":8}],"children":[],"metadata":{"merge":{"soureCodePorts":["expression"]}}},{"id":"7eaba45d-97e3-6053-3f81-331c05c865ca","type":"Group","x":-141,"y":-31,"parameters":{"backgroundColor":"White","justifyContent":"flex-start","paddingTop":{"value":24,"unit":"px"}},"ports":[],"dynamicports":[],"children":[{"id":"a1378d19-2a11-2758-c91b-f14c6241c2bb","type":"Text","label":"Verification email was sent","parameters":{"text":"","textAlignX":"center"},"ports":[],"dynamicports":[],"children":[]},{"id":"81725f3a-9b69-682b-1ccb-2976475d3630","type":"Text","parameters":{"text":"1. Verify it\n2. Log in on this page","textAlignX":"center"},"ports":[],"dynamicports":[],"children":[]}]},{"id":"40e6767d-902c-4f3b-c9f5-a3332af79bbd","type":"String Format","x":-318,"y":17,"parameters":{"format":"A verification link was emailed to: {userEmail}","userEmail":""},"ports":[],"dynamicports":[{"name":"userEmail","type":"string","plug":"input","index":2}],"children":[]}],"visualRoots":["7eaba45d-97e3-6053-3f81-331c05c865ca"],"comments":[{"text":"We output the array 'providerData' from currentUser object ","width":167,"height":189,"fill":"transparent","x":-837,"y":-66,"id":"a8795f27-b4ef-c0af-edfa-57e83be42043"},{"text":"Alternative script with a FUNCTION node: \nOutputs.userEmail = Inputs.providerData[0].email;\nfor outputting userEmail from the providerData input","width":346,"height":82,"fill":"transparent","x":-655,"y":223,"id":"5d14bad0-2271-48f6-a12e-0738744a4a05"}]}},{"name":"/Firebase/Firebase - Get Current User","id":"b7be6952-575d-223a-314a-edfb832ecad1","graph":{"connections":[{"fromId":"111c5f1b-4cc4-20a6-119c-edb6cd89df98","fromProperty":"Do","toId":"99ad1749-9a13-5289-c025-89a0ab0cfe7b","toProperty":"run"},{"fromId":"99ad1749-9a13-5289-c025-89a0ab0cfe7b","fromProperty":"out-loggedIn","toId":"fa099360-38c7-68c9-004e-667a9b5c8e3f","toProperty":"prop-loggedIn"},{"fromId":"99ad1749-9a13-5289-c025-89a0ab0cfe7b","fromProperty":"out-isAnonymous","toId":"fa099360-38c7-68c9-004e-667a9b5c8e3f","toProperty":"prop-isAnonymous"},{"fromId":"fa099360-38c7-68c9-004e-667a9b5c8e3f","fromProperty":"stored","toId":"dce2cb9f-a909-d0e9-c408-139f5f61e7e9","toProperty":"Done"},{"fromId":"99ad1749-9a13-5289-c025-89a0ab0cfe7b","fromProperty":"out-loggedIn","toId":"dce2cb9f-a909-d0e9-c408-139f5f61e7e9","toProperty":"loggedIn"},{"fromId":"99ad1749-9a13-5289-c025-89a0ab0cfe7b","fromProperty":"out-Done","toId":"fa099360-38c7-68c9-004e-667a9b5c8e3f","toProperty":"store"},{"fromId":"99ad1749-9a13-5289-c025-89a0ab0cfe7b","fromProperty":"out-idToken","toId":"fa099360-38c7-68c9-004e-667a9b5c8e3f","toProperty":"prop-idToken"},{"fromId":"99ad1749-9a13-5289-c025-89a0ab0cfe7b","fromProperty":"out-emailVerified","toId":"dce2cb9f-a909-d0e9-c408-139f5f61e7e9","toProperty":"isEmailVerified"},{"fromId":"99ad1749-9a13-5289-c025-89a0ab0cfe7b","fromProperty":"out-email","toId":"fa099360-38c7-68c9-004e-667a9b5c8e3f","toProperty":"prop-email"},{"fromId":"99ad1749-9a13-5289-c025-89a0ab0cfe7b","fromProperty":"out-emailVerified","toId":"fa099360-38c7-68c9-004e-667a9b5c8e3f","toProperty":"prop-emailVerified"}],"roots":[{"id":"111c5f1b-4cc4-20a6-119c-edb6cd89df98","type":"Component Inputs","x":-41,"y":-153,"parameters":{},"ports":[{"name":"Do","plug":"output","type":"*","index":0}],"dynamicports":[],"children":[]},{"id":"dce2cb9f-a909-d0e9-c408-139f5f61e7e9","type":"Component Outputs","x":675,"y":-9,"parameters":{},"ports":[{"name":"Done","plug":"input","type":{"name":"*"},"index":11},{"name":"loggedIn","plug":"input","type":{"name":"*"},"index":12},{"name":"isEmailVerified","plug":"input","type":{"name":"*"},"index":13}],"dynamicports":[],"children":[]},{"id":"99ad1749-9a13-5289-c025-89a0ab0cfe7b","type":"JavaScriptFunction","label":"Get Current User","x":150,"y":-163.33333333333331,"parameters":{"functionScript":"if (!Boolean(Noodl.Variables.firebaseAuth)) {\r\n  console.error(\"Firebase is not configured or initialized!\");\r\n  return; // Stops the function if Firebase App is not initialized\r\n}\r\n\r\n// Initialize the firebase Auth service\r\nconst auth = window.getAuth();\r\n\r\nauth.onAuthStateChanged((user) => {\r\n  if (user) {\r\n    // User is signed in\r\n    console.log(\"User is signed in\");\r\n\r\n    // Store user details in Noodl.Objects\r\n    Noodl.Objects.currentUser = {\r\n      uid: user.uid,\r\n      emailVerified: user.emailVerified,\r\n      isAnonymous: user.isAnonymous,\r\n      tenantId: user.tenantId,\r\n      userCreationTime: user.metadata.creationTime,\r\n      userLastSignInTime: user.metadata.lastSignInTime,\r\n      refreshToken: user.refreshToken,\r\n      providerData: user.providerData.map((userInfo) => ({\r\n        displayName: userInfo.displayName,\r\n        email: userInfo.email,\r\n        phoneNumber: userInfo.phoneNumber,\r\n        providerId: userInfo.providerId,\r\n        photoURL: userInfo.photoURL\r\n      }))\r\n    };\r\n\r\n    // Indicate the user is logged in\r\n    Outputs.loggedIn = Boolean(user);\r\n    Outputs.email = user.email;\r\n    Outputs.emailVerified = user.emailVerified;\r\n\r\n    // Get the JWT ID Token and output it\r\n    user.getIdToken().then((token) => {\r\n      Outputs.idToken = token;\r\n\r\n    }).catch((error) => {\r\n      console.error(\"Error getting ID token: \", error);\r\n    });\r\n  } else {\r\n    // User is signed out\r\n    console.log(\"User is signed out\");\r\n    Noodl.Objects.currentUser = null; // Clear the current user object\r\n    Outputs.loggedIn = false; // Indicate user is not logged in\r\n  }\r\n  Outputs.Done();\r\n});","scriptOutputs":[{"id":"i7yq","label":"emailVerified"},{"id":"vqty","label":"isAnonymous"},{"id":"na9e","label":"userCreationTime"},{"id":"tgqb","label":"userLastSignInTime"},{"id":"vvu6","label":"idToken"},{"id":"fyz9","label":"providerId"},{"id":"uoun","label":"tenantId"},{"id":"krlv","label":"userDisplayName"},{"id":"ogz4","label":"email"},{"id":"g79c","label":"loggedIn"}],"outtype-emailVerified":"boolean","outtype-isAnonymous":"boolean","outtype-anon":"boolean","outtype-verified":"boolean","outtype-userCreationTime":"date","outtype-userLastSignInTime":"date","outtype-loggedIn":"boolean"},"ports":[],"dynamicports":[{"name":"outtype-emailVerified","displayName":"Type","editorName":"emailVerified | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"},{"value":"signal","label":"Signal"}],"allowEditOnly":true},"default":"string","parent":"scriptOutputs","parentItemId":"i7yq","index":4},{"name":"out-emailVerified","displayName":"emailVerified","plug":"output","type":"boolean","group":"Outputs","index":5},{"name":"outtype-isAnonymous","displayName":"Type","editorName":"isAnonymous | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"},{"value":"signal","label":"Signal"}],"allowEditOnly":true},"default":"string","parent":"scriptOutputs","parentItemId":"vqty","index":6},{"name":"out-isAnonymous","displayName":"isAnonymous","plug":"output","type":"boolean","group":"Outputs","index":7},{"name":"outtype-userCreationTime","displayName":"Type","editorName":"userCreationTime | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"},{"value":"signal","label":"Signal"}],"allowEditOnly":true},"default":"string","parent":"scriptOutputs","parentItemId":"na9e","index":8},{"name":"out-userCreationTime","displayName":"userCreationTime","plug":"output","type":"date","group":"Outputs","index":9},{"name":"outtype-userLastSignInTime","displayName":"Type","editorName":"userLastSignInTime | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"},{"value":"signal","label":"Signal"}],"allowEditOnly":true},"default":"string","parent":"scriptOutputs","parentItemId":"tgqb","index":10},{"name":"out-userLastSignInTime","displayName":"userLastSignInTime","plug":"output","type":"date","group":"Outputs","index":11},{"name":"outtype-idToken","displayName":"Type","editorName":"idToken | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"},{"value":"signal","label":"Signal"}],"allowEditOnly":true},"default":"string","parent":"scriptOutputs","parentItemId":"vvu6","index":12},{"name":"out-idToken","displayName":"idToken","plug":"output","type":"*","group":"Outputs","index":13},{"name":"outtype-providerId","displayName":"Type","editorName":"providerId | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"},{"value":"signal","label":"Signal"}],"allowEditOnly":true},"default":"string","parent":"scriptOutputs","parentItemId":"fyz9","index":14},{"name":"out-providerId","displayName":"providerId","plug":"output","type":"*","group":"Outputs","index":15},{"name":"outtype-tenantId","displayName":"Type","editorName":"tenantId | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"},{"value":"signal","label":"Signal"}],"allowEditOnly":true},"default":"string","parent":"scriptOutputs","parentItemId":"uoun","index":16},{"name":"out-tenantId","displayName":"tenantId","plug":"output","type":"*","group":"Outputs","index":17},{"name":"outtype-userDisplayName","displayName":"Type","editorName":"userDisplayName | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"},{"value":"signal","label":"Signal"}],"allowEditOnly":true},"default":"string","parent":"scriptOutputs","parentItemId":"krlv","index":18},{"name":"out-userDisplayName","displayName":"userDisplayName","plug":"output","type":"*","group":"Outputs","index":19},{"name":"outtype-email","displayName":"Type","editorName":"email | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"},{"value":"signal","label":"Signal"}],"allowEditOnly":true},"default":"string","parent":"scriptOutputs","parentItemId":"ogz4","index":20},{"name":"out-email","displayName":"email","plug":"output","type":"*","group":"Outputs","index":21},{"name":"outtype-loggedIn","displayName":"Type","editorName":"loggedIn | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"},{"value":"signal","label":"Signal"}],"allowEditOnly":true},"default":"string","parent":"scriptOutputs","parentItemId":"g79c","index":22},{"name":"out-loggedIn","displayName":"loggedIn","plug":"output","type":"boolean","group":"Outputs","index":23},{"name":"out-Done","displayName":"Done","plug":"output","type":"signal","group":"Outputs","index":24}],"children":[],"metadata":{"merge":{"soureCodePorts":["functionScript"]}}},{"id":"fa099360-38c7-68c9-004e-667a9b5c8e3f","type":"SetModelProperties","x":439.3333333333332,"y":-209.1111111111111,"parameters":{"modelId":"currentUser","idSource":"explicit","properties":"loggedIn,emailVerified,isAnonymous,idToken,email","type-loggedIn":"boolean","type-emailVerified":"boolean","type-isAnonymous":"boolean","type-userCreaTime":"date","type-userLastSigninTime":"date","type-idToken":"string","type-email":"string"},"ports":[],"dynamicports":[{"type":{"name":"boolean"},"plug":"input","group":"Property Values","displayName":"loggedIn","name":"prop-loggedIn","index":6},{"type":{"name":"enum","enums":[{"label":"String","value":"string"},{"label":"Boolean","value":"boolean"},{"label":"Number","value":"number"},{"label":"Date","value":"date"},{"label":"Array","value":"array"},{"label":"Object","value":"object"},{"label":"Any","value":"*"}],"allowEditOnly":true},"plug":"input","group":"Property Types","displayName":"loggedIn","default":"*","name":"type-loggedIn","index":7},{"type":{"name":"boolean"},"plug":"input","group":"Property Values","displayName":"emailVerified","name":"prop-emailVerified","index":8},{"type":{"name":"enum","enums":[{"label":"String","value":"string"},{"label":"Boolean","value":"boolean"},{"label":"Number","value":"number"},{"label":"Date","value":"date"},{"label":"Array","value":"array"},{"label":"Object","value":"object"},{"label":"Any","value":"*"}],"allowEditOnly":true},"plug":"input","group":"Property Types","displayName":"emailVerified","default":"*","name":"type-emailVerified","index":9},{"type":{"name":"boolean"},"plug":"input","group":"Property Values","displayName":"isAnonymous","name":"prop-isAnonymous","index":10},{"type":{"name":"enum","enums":[{"label":"String","value":"string"},{"label":"Boolean","value":"boolean"},{"label":"Number","value":"number"},{"label":"Date","value":"date"},{"label":"Array","value":"array"},{"label":"Object","value":"object"},{"label":"Any","value":"*"}],"allowEditOnly":true},"plug":"input","group":"Property Types","displayName":"isAnonymous","default":"*","name":"type-isAnonymous","index":11},{"type":{"name":"string"},"plug":"input","group":"Property Values","displayName":"idToken","name":"prop-idToken","index":12},{"type":{"name":"enum","enums":[{"label":"String","value":"string"},{"label":"Boolean","value":"boolean"},{"label":"Number","value":"number"},{"label":"Date","value":"date"},{"label":"Array","value":"array"},{"label":"Object","value":"object"},{"label":"Any","value":"*"}],"allowEditOnly":true},"plug":"input","group":"Property Types","displayName":"idToken","default":"*","name":"type-idToken","index":13},{"type":{"name":"string"},"plug":"input","group":"Property Values","displayName":"email","name":"prop-email","index":14},{"type":{"name":"enum","enums":[{"label":"String","value":"string"},{"label":"Boolean","value":"boolean"},{"label":"Number","value":"number"},{"label":"Date","value":"date"},{"label":"Array","value":"array"},{"label":"Object","value":"object"},{"label":"Any","value":"*"}],"allowEditOnly":true},"plug":"input","group":"Property Types","displayName":"email","default":"*","name":"type-email","index":15}],"children":[]}],"visualRoots":[],"comments":[{"text":"'currentUser' can be reused as id in an Object  node anywhere in the project to make its properties available","width":180,"height":322,"fill":"transparent","x":423,"y":-321,"id":"1a741b3c-c058-6a8c-255c-f84cf01b31cb"}]}},{"name":"/Firebase/Firebase_init - Setup Client","id":"57e49d78-d0d9-99ca-aebe-dc9358c55e7f","graph":{"connections":[{"fromId":"21205ad9-1fa8-07ec-3bfb-3a6333c62fb0","fromProperty":"savedValue","toId":"50138787-5dc1-c27a-1e07-7a35fa5b2290","toProperty":"value"},{"fromId":"166ccce7-2200-3048-7d20-560592197ed8","fromProperty":"changed","toId":"21205ad9-1fa8-07ec-3bfb-3a6333c62fb0","toProperty":"saveValue"},{"fromId":"8382fd33-cf11-32de-1bf5-552d774617bf","fromProperty":"savedValue","toId":"166ccce7-2200-3048-7d20-560592197ed8","toProperty":"value"},{"fromId":"b34e32b6-81a3-4e11-6e0b-3d6c29c14c1d","fromProperty":"apiKey","toId":"70aae2bd-7264-0606-f7cf-e595948c6ea8","toProperty":"value"},{"fromId":"b34e32b6-81a3-4e11-6e0b-3d6c29c14c1d","fromProperty":"authDomain","toId":"c1615425-8879-7ca9-b70a-78576ffc2af4","toProperty":"value"},{"fromId":"b34e32b6-81a3-4e11-6e0b-3d6c29c14c1d","fromProperty":"projectId","toId":"afeebf4f-3804-3420-f7fc-29a468c9435f","toProperty":"value"},{"fromId":"b34e32b6-81a3-4e11-6e0b-3d6c29c14c1d","fromProperty":"storageBucket","toId":"62299380-fe3d-95b7-29d6-914a973d3e88","toProperty":"value"},{"fromId":"b34e32b6-81a3-4e11-6e0b-3d6c29c14c1d","fromProperty":"messagingSenderId","toId":"cfd05114-2160-68c7-3aa5-8b8128223924","toProperty":"value"},{"fromId":"b34e32b6-81a3-4e11-6e0b-3d6c29c14c1d","fromProperty":"appId","toId":"5d8957f5-c624-9849-2673-7c0e3f00b761","toProperty":"value"},{"fromId":"70aae2bd-7264-0606-f7cf-e595948c6ea8","fromProperty":"savedValue","toId":"c0135ee9-bc7e-9647-04fc-74a985ea1520","toProperty":"in-apiKey"},{"fromId":"c1615425-8879-7ca9-b70a-78576ffc2af4","fromProperty":"savedValue","toId":"c0135ee9-bc7e-9647-04fc-74a985ea1520","toProperty":"in-authDomain"},{"fromId":"afeebf4f-3804-3420-f7fc-29a468c9435f","fromProperty":"savedValue","toId":"c0135ee9-bc7e-9647-04fc-74a985ea1520","toProperty":"in-projectId"},{"fromId":"62299380-fe3d-95b7-29d6-914a973d3e88","fromProperty":"savedValue","toId":"c0135ee9-bc7e-9647-04fc-74a985ea1520","toProperty":"in-storageBucket"},{"fromId":"cfd05114-2160-68c7-3aa5-8b8128223924","fromProperty":"savedValue","toId":"c0135ee9-bc7e-9647-04fc-74a985ea1520","toProperty":"in-messagingSenderId"},{"fromId":"5d8957f5-c624-9849-2673-7c0e3f00b761","fromProperty":"savedValue","toId":"c0135ee9-bc7e-9647-04fc-74a985ea1520","toProperty":"in-appId"},{"fromId":"b34e32b6-81a3-4e11-6e0b-3d6c29c14c1d","fromProperty":"Do","toId":"c0135ee9-bc7e-9647-04fc-74a985ea1520","toProperty":"run"},{"fromId":"c0135ee9-bc7e-9647-04fc-74a985ea1520","fromProperty":"out-Success","toId":"34099534-9fc2-85fe-1d05-ecfe1015d341","toProperty":"Success"},{"fromId":"c0135ee9-bc7e-9647-04fc-74a985ea1520","fromProperty":"out-Failure","toId":"34099534-9fc2-85fe-1d05-ecfe1015d341","toProperty":"Failure"}],"roots":[{"id":"b34e32b6-81a3-4e11-6e0b-3d6c29c14c1d","type":"Component Inputs","x":-487.3684210526315,"y":-148.8421052631578,"parameters":{},"ports":[{"name":"Do","plug":"output","type":"*","index":0},{"name":"apiKey","plug":"output","type":{"name":"*"},"index":1},{"name":"authDomain","plug":"output","type":{"name":"*"},"index":2},{"name":"projectId","plug":"output","type":{"name":"*"},"index":3},{"name":"storageBucket","plug":"output","type":{"name":"*"},"index":4},{"name":"messagingSenderId","plug":"output","type":{"name":"*"},"index":5},{"name":"appId","plug":"output","type":{"name":"*"},"index":6}],"dynamicports":[],"children":[]},{"id":"34099534-9fc2-85fe-1d05-ecfe1015d341","type":"Component Outputs","x":288,"y":9,"parameters":{},"ports":[{"name":"Success","plug":"input","type":"*","index":0},{"name":"Failure","plug":"input","type":"*","index":1}],"dynamicports":[],"children":[]},{"id":"c0135ee9-bc7e-9647-04fc-74a985ea1520","type":"JavaScriptFunction","x":81.10803324099732,"y":-108.17313019390582,"parameters":{"functionScript":"if (Boolean(Noodl.Variables.firebaseApp)) {\n    console.log(\"Firebase client is already set up\");\n    return; // Stops if the client already exists\n}\n\n// Inputs from the Noodl component, provided manually via the component's UI\nconst firebaseConfig = {\n    apiKey: Inputs.apiKey,\n    authDomain: Inputs.authDomain,\n    projectId: Inputs.projectId,\n    storageBucket: Inputs.storageBucket,\n    messagingSenderId: Inputs.messagingSenderId,\n    appId: Inputs.appId,\n};\n\ntry {\n    // Utilize the global 'window' object to import and initialize Firebase, ensuring Firebase SDKs are loaded\n    // This assumes Firebase SDKs are available in the global scope\n    const app = window.initializeApp(firebaseConfig);\n    const auth = window.getAuth(app);\n\n    // Store the Firebase app instance in Noodl variables for global access within the Noodl project\n    Noodl.Variables.firebaseAuth = auth;\n\n    console.log(\"[Initialize] Firebase is now initialized\");\n    Outputs.Success(); // Signal success in initialization\n} catch (e) {\n    console.error(\"[Initialize] Error initializing Firebase: \", e);\n    Outputs.Failure(); // Signal failure in initialization\n}","scriptInputs":[{"id":"rfto","label":"apiKey"},{"id":"n0bq","label":"authDomain"},{"id":"u9ag","label":"projectId"},{"id":"2i2d","label":"storageBucket"},{"id":"ogpk","label":"messagingSenderId"},{"id":"nwuv","label":"appId"}]},"ports":[],"dynamicports":[{"name":"intype-apiKey","displayName":"Type","editorName":"apiKey | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"}],"allowEditOnly":true},"default":"string","parent":"scriptInputs","parentItemId":"rfto","index":4},{"name":"in-apiKey","displayName":"apiKey","plug":"input","type":"string","group":"Inputs","index":5},{"name":"intype-authDomain","displayName":"Type","editorName":"authDomain | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"}],"allowEditOnly":true},"default":"string","parent":"scriptInputs","parentItemId":"n0bq","index":6},{"name":"in-authDomain","displayName":"authDomain","plug":"input","type":"string","group":"Inputs","index":7},{"name":"intype-projectId","displayName":"Type","editorName":"projectId | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"}],"allowEditOnly":true},"default":"string","parent":"scriptInputs","parentItemId":"u9ag","index":8},{"name":"in-projectId","displayName":"projectId","plug":"input","type":"string","group":"Inputs","index":9},{"name":"intype-storageBucket","displayName":"Type","editorName":"storageBucket | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"}],"allowEditOnly":true},"default":"string","parent":"scriptInputs","parentItemId":"2i2d","index":10},{"name":"in-storageBucket","displayName":"storageBucket","plug":"input","type":"string","group":"Inputs","index":11},{"name":"intype-messagingSenderId","displayName":"Type","editorName":"messagingSenderId | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"}],"allowEditOnly":true},"default":"string","parent":"scriptInputs","parentItemId":"ogpk","index":12},{"name":"in-messagingSenderId","displayName":"messagingSenderId","plug":"input","type":"string","group":"Inputs","index":13},{"name":"intype-appId","displayName":"Type","editorName":"appId | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"}],"allowEditOnly":true},"default":"string","parent":"scriptInputs","parentItemId":"nwuv","index":14},{"name":"in-appId","displayName":"appId","plug":"input","type":"string","group":"Inputs","index":15},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":16},{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":17}],"children":[],"metadata":{"merge":{"soureCodePorts":["functionScript"]}}},{"id":"21205ad9-1fa8-07ec-3bfb-3a6333c62fb0","type":"String","x":-916,"y":203,"parameters":{"value":"authSession"},"ports":[],"dynamicports":[],"children":[]},{"id":"50138787-5dc1-c27a-1e07-7a35fa5b2290","type":"Variable2","x":-668,"y":208,"parameters":{"name":"Supabase_session"},"ports":[],"dynamicports":[],"children":[]},{"id":"8382fd33-cf11-32de-1bf5-552d774617bf","type":"String","x":-920,"y":-124,"parameters":{"value":"user_profile"},"ports":[],"dynamicports":[],"children":[]},{"id":"166ccce7-2200-3048-7d20-560592197ed8","type":"Variable2","x":-671,"y":-59,"parameters":{"name":"Supabase_userProfileTableName"},"ports":[],"dynamicports":[],"children":[]},{"id":"70aae2bd-7264-0606-f7cf-e595948c6ea8","type":"String","x":-215.66541353383445,"y":-211.4548872180451,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"c1615425-8879-7ca9-b70a-78576ffc2af4","type":"String","x":-213.57894736842104,"y":-128.78947368421052,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"afeebf4f-3804-3420-f7fc-29a468c9435f","type":"String","x":-216.1578947368422,"y":-45.73684210526312,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"62299380-fe3d-95b7-29d6-914a973d3e88","type":"String","x":-217.42105263157896,"y":38.78947368421052,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"cfd05114-2160-68c7-3aa5-8b8128223924","type":"String","x":-217.7894736842104,"y":120.21052631578948,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"5d8957f5-c624-9849-2673-7c0e3f00b761","type":"String","x":-220.10526315789468,"y":207.36842105263156,"parameters":{},"ports":[],"dynamicports":[],"children":[]}],"visualRoots":[],"comments":[{"text":"Creates the firebase instance and stores it in a Noodl Variable","width":178,"height":305,"fill":true,"x":67,"y":-187,"id":"429038d0-9816-0e53-0686-6a9e6f2c786b","color":"script"},{"text":"HEAD PAGE SETUP\nIn your Project settings sidebar, Custom Code section, add the below Head Code:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFirebase SDK version 9.0.0 is compatible with current setup, no version 9+.","width":1079,"height":588,"fill":true,"x":-591,"y":-806,"id":"81eb2055-81b4-4baf-ae2c-6565ff0218a8","largeFont":true},{"text":"<script type=\"module\">\n  import { initializeApp } from \"https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js\";\n  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, sendEmailVerification, sendPasswordResetEmail, verifyBeforeUpdateEmail, updatePassword, EmailAuthProvider, reauthenticateWithCredential, signOut } from \"https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js\";\n  import { getFirestore } from \"https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js\";\n  \n  // Expose Firebase initialization and auth functions to the global scope\n  window.initializeApp = initializeApp;\n  window.getAuth = getAuth;\n  window.createUserWithEmailAndPassword = createUserWithEmailAndPassword;\n  window.signInWithEmailAndPassword = signInWithEmailAndPassword;\n  window.onAuthStateChanged = onAuthStateChanged;\n  window.sendEmailVerification = sendEmailVerification;\n  window.sendPasswordResetEmail = sendPasswordResetEmail;\n  window.verifyBeforeUpdateEmail = verifyBeforeUpdateEmail;\n  window.updatePassword = updatePassword;\n  window.EmailAuthProvider = EmailAuthProvider;\n  window.reauthenticateWithCredential = reauthenticateWithCredential;\n  window.getFirestore = getFirestore;\n</script>\n<script src=\"https://cdn.jsdelivr.net/npm/validator/validator.min.js\"></script>\n<script>\n  window.validator = validator;\n</script>","width":1043,"height":456,"fill":true,"x":-574,"y":-726,"id":"9483fc55-27b3-d428-d3bf-dea1130459f1","color":"comment"},{"text":"Set the localstorage keyName to save the AuthSession","width":430,"height":205,"fill":true,"x":-932,"y":107,"id":"643dde99-aa65-a814-1205-ec986f88d9a4"},{"text":"Set the user profile table name","width":440,"height":260,"fill":true,"x":-940,"y":-187,"id":"b1f3d073-14e0-30c3-6cb2-2aaec9c5b2d5"}]}},{"name":"/Firebase/Password Reset/Firebase - Send Password Reset","id":"fdda83a6-dbef-d0d2-a359-40736075fbf8","graph":{"connections":[{"fromId":"585648d6-9391-8984-c034-db59c9e39a33","fromProperty":"Do","toId":"3493c084-a0e9-eac9-8408-b8731df576d9","toProperty":"run"},{"fromId":"3493c084-a0e9-eac9-8408-b8731df576d9","fromProperty":"out-Failure","toId":"c89da7bb-fa84-876c-0458-e3f1ad7a74f1","toProperty":"Failure"},{"fromId":"3493c084-a0e9-eac9-8408-b8731df576d9","fromProperty":"out-Success","toId":"c89da7bb-fa84-876c-0458-e3f1ad7a74f1","toProperty":"Success"},{"fromId":"3493c084-a0e9-eac9-8408-b8731df576d9","fromProperty":"out-error","toId":"c89da7bb-fa84-876c-0458-e3f1ad7a74f1","toProperty":"Error"},{"fromId":"3493c084-a0e9-eac9-8408-b8731df576d9","fromProperty":"out-email","toId":"c89da7bb-fa84-876c-0458-e3f1ad7a74f1","toProperty":"email"},{"fromId":"585648d6-9391-8984-c034-db59c9e39a33","fromProperty":"email","toId":"3493c084-a0e9-eac9-8408-b8731df576d9","toProperty":"in-email"}],"roots":[{"id":"585648d6-9391-8984-c034-db59c9e39a33","type":"Component Inputs","x":-104,"y":-89,"parameters":{},"ports":[{"name":"Do","plug":"output","type":"*","index":0},{"name":"email","plug":"output","type":{"name":"*"},"index":1}],"dynamicports":[],"children":[]},{"id":"c89da7bb-fa84-876c-0458-e3f1ad7a74f1","type":"Component Outputs","x":374,"y":-50,"parameters":{},"ports":[{"name":"Success","plug":"input","type":"*","index":0},{"name":"Failure","plug":"input","type":"*","index":1},{"name":"Error","plug":"input","type":{"name":"*"},"index":2},{"name":"email","plug":"input","type":{"name":"*"},"index":3}],"dynamicports":[],"children":[]},{"id":"3493c084-a0e9-eac9-8408-b8731df576d9","type":"JavaScriptFunction","label":"sendPasswordResetEmail","x":105.66666666666663,"y":-91,"parameters":{"functionScript":"if (!Boolean(Noodl.Variables.firebaseAuth)) {\r\n    console.error(\"Firebase Auth is not configured!\");\r\n    Outputs.Failure();\r\n    return; // Stops the function if Firebase Auth is not initialized\r\n}\r\n\r\n// Retrieve the email address from the input\r\nconst email = Inputs.email;\r\n\r\nif (email) {\r\n    // Call sendPasswordResetEmail for the provided email\r\n    window.sendPasswordResetEmail(Noodl.Variables.firebaseAuth, email)\r\n        .then(() => {\r\n            console.log(\"Password reset email sent.\");\r\n            Outputs.email = email;\r\n            Outputs.Success();\r\n        })\r\n        .catch((error) => {\r\n            console.error(\"Error sending password reset email: \", error.code, error.message);\r\n            console.log(\"Caught error code:\", error.code); // Log the error code\r\n            // Handle specific errors with Outputs.error\r\n            switch (error.code) {\r\n                case \"auth/invalid-email\":\r\n                    Outputs.error = \"Invalid email\";\r\n                    break;\r\n//                case \"auth/user-not-found\":\r\n//                    Outputs.error = \"User not found\"; //\r\n//                    break;\r\n                default:\r\n                    Outputs.error = \"Password reset email send failed\";\r\n            }\r\n            Outputs.Failure();\r\n        });\r\n} else {\r\n    console.log(\"Email address is required.\");\r\n    Outputs.error = \"Email address is required\";\r\n    Outputs.Failure();\r\n}"},"ports":[],"dynamicports":[{"name":"in-email","displayName":"email","plug":"input","type":"*","group":"Inputs","index":4},{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":5},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":6},{"name":"out-email","displayName":"email","plug":"output","type":"*","group":"Outputs","index":7},{"name":"out-error","displayName":"error","plug":"output","type":"*","group":"Outputs","index":8}],"children":[],"metadata":{"merge":{"soureCodePorts":["functionScript"]}}}],"visualRoots":[],"comments":[{"text":"⚠️ The sendPasswordResetEmail function does not provide a success response only when the user exists; it's designed to return a \"success\" response even if the email is not associated with any user, to prevent enumeration attacks where an attacker could use this function to discover valid email addresses. Firebase's behavior is to silently fail, meaning it does not disclose whether an email is linked to an existing account or not, for privacy and security reasons.","width":455,"height":156,"fill":"transparent","x":105,"y":-247,"id":"3327e6a1-cf8b-cb8e-790f-c1aeeda611b1"}]}},{"name":"/Firebase/Password Reset/Firebase - Sent Pwd Reset Email Popup","id":"63b7f9b2-1871-4b49-def7-00539fa99c42","graph":{"connections":[{"fromId":"ac75e5d6-fa3e-f7d1-7441-ecd9fe53c8b7","fromProperty":"formatted","toId":"134b6953-c38b-5308-d258-f5ef265da77c","toProperty":"text"},{"fromId":"88ddd547-429b-1054-71f2-4e35210c7a35","fromProperty":"email","toId":"ac75e5d6-fa3e-f7d1-7441-ecd9fe53c8b7","toProperty":"email"},{"fromId":"577fc3bf-cc0d-aa2f-6419-089846821cdb","fromProperty":"onClick","toId":"cbb8f685-ea12-c344-22f2-a5056477b62f","toProperty":"navigate"}],"roots":[{"id":"1a572539-cf45-a03f-5501-1be3b6c95203","type":"Group","x":177,"y":0,"parameters":{"backgroundColor":"Grey - 400","justifyContent":"flex-start","paddingTop":{"value":24,"unit":"px"}},"ports":[],"dynamicports":[],"children":[{"id":"134b6953-c38b-5308-d258-f5ef265da77c","type":"Text","label":"Password reset link emailed","parameters":{"text":"","textAlignX":"center"},"ports":[],"dynamicports":[],"children":[]},{"id":"577fc3bf-cc0d-aa2f-6419-089846821cdb","type":"net.noodl.controls.button","label":"Back to Login","parameters":{"alignX":"center","marginTop":{"value":16,"unit":"px"},"label":"Back to Login"},"ports":[],"dynamicports":[],"children":[]}]},{"id":"ac75e5d6-fa3e-f7d1-7441-ecd9fe53c8b7","type":"String Format","x":0,"y":48,"parameters":{"format":"Password reset link emailed to {email}\nIf you did not receive it, please verify the email address.","userEmail":""},"ports":[],"dynamicports":[{"name":"email","type":"string","plug":"input","index":2}],"children":[]},{"id":"88ddd547-429b-1054-71f2-4e35210c7a35","type":"Component Inputs","x":-217,"y":46,"parameters":{},"ports":[{"name":"email","plug":"output","type":{"name":"*"},"index":0}],"dynamicports":[],"children":[]},{"id":"cbb8f685-ea12-c344-22f2-a5056477b62f","type":"RouterNavigate","x":426.66666666666663,"y":160.33333333333331,"parameters":{"router":"Firebase Main","target":"/Firebase/User Auth/SignUp-SignIn with Firebase Eml & Pwd"},"ports":[],"dynamicports":[{"plug":"input","type":{"name":"enum","enums":[{"label":"Supabase Not Logged In Router","value":"Supabase Not Logged In Router"},{"label":"Supabase Logged In Router","value":"Supabase Logged In Router"},{"label":"Firebase Main","value":"Firebase Main"}],"allowEditOnly":true},"group":"General","displayName":"Router","name":"router","index":3},{"plug":"input","type":{"name":"component","title":"Choose page component","components":["/Firebase/Start Page","/Firebase/User Auth/SignUp-SignIn with Firebase Eml & Pwd","/Firebase/Password Reset/Reset Firebase Password","/Firebase/Verify & Update Email/Update Firebase Email","/Firebase/User Auth/Sign-out","/Firebase/Delete Account/Delete Account"],"allowEditOnly":true},"group":"General","displayName":"Target Page","name":"target","index":4}],"children":[]}],"visualRoots":["1a572539-cf45-a03f-5501-1be3b6c95203"]}},{"name":"/Firebase/Password Reset/Reset Firebase Password","id":"19aefb69-25d0-50d5-a4c1-8354ba6e5090","graph":{"connections":[{"fromId":"97bbadfa-d2ab-eab7-ad10-76838e78534d","fromProperty":"onTextChanged","toId":"9569c72a-46df-3051-b201-2e9eada50240","toProperty":"email"},{"fromId":"9569c72a-46df-3051-b201-2e9eada50240","fromProperty":"email","toId":"7850d63b-5ec6-dfb2-763b-0779a781a2d6","toProperty":"popupParam-email"},{"fromId":"9569c72a-46df-3051-b201-2e9eada50240","fromProperty":"Success","toId":"97bbadfa-d2ab-eab7-ad10-76838e78534d","toProperty":"clear"},{"fromId":"e7960b46-0f04-ba74-6f8d-3f5e0da532e4","fromProperty":"onClick","toId":"9569c72a-46df-3051-b201-2e9eada50240","toProperty":"Do"},{"fromId":"9569c72a-46df-3051-b201-2e9eada50240","fromProperty":"Success","toId":"7850d63b-5ec6-dfb2-763b-0779a781a2d6","toProperty":"show"},{"fromId":"9569c72a-46df-3051-b201-2e9eada50240","fromProperty":"Error","toId":"08ece10e-08bd-23ec-fe10-b69a6bfac597","toProperty":"text"},{"fromId":"6126a77c-12a6-f473-c83d-6e6cb748f772","fromProperty":"state","toId":"08ece10e-08bd-23ec-fe10-b69a6bfac597","toProperty":"mounted"},{"fromId":"9569c72a-46df-3051-b201-2e9eada50240","fromProperty":"Error","toId":"6126a77c-12a6-f473-c83d-6e6cb748f772","toProperty":"onFromStart"}],"roots":[{"id":"4e769551-9d39-2ee2-54bc-7b67669d6003","type":"Page","label":"Page Reset Pwd","x":-268.25683817239747,"y":-192.8420108230763,"parameters":{},"ports":[],"dynamicports":[{"name":"title","displayName":"Title","type":"string","group":"General","plug":"input","default":"Reset Firebase Password","index":31},{"name":"urlPath","displayName":"Url Path","type":"string","group":"General","plug":"input","default":"reset-firebase-password","index":32}],"children":[{"id":"eb99a28e-08c7-84c6-4a84-f81d6c37be51","type":"Group","label":"Reset password form","parameters":{"flexDirection":"column","backgroundColor":"#FFFFFF","borderRadius":{"value":8,"unit":"px"},"sizeMode":"contentHeight","clip":true},"ports":[],"dynamicports":[],"children":[{"id":"a8df7145-7aa0-b8e0-b5a8-7f53527ae496","type":"Text","label":"","parameters":{"text":"Reset Password","marginBottom":{"value":16,"unit":"px"}},"ports":[],"dynamicports":[],"children":[]},{"id":"97bbadfa-d2ab-eab7-ad10-76838e78534d","type":"net.noodl.controls.textinput","label":"Email Input","parameters":{"label":"","type":"email","placeholder":"Email","marginBottom":{"value":8,"unit":"px"}},"ports":[],"dynamicports":[],"children":[]},{"id":"08ece10e-08bd-23ec-fe10-b69a6bfac597","type":"Text","label":"Error alert","parameters":{"text":"","color":"Danger","fontSize":{"value":12,"unit":"px"}},"ports":[],"dynamicports":[],"children":[]},{"id":"e7960b46-0f04-ba74-6f8d-3f5e0da532e4","type":"net.noodl.controls.button","parameters":{"label":"Send reset password email"},"ports":[],"dynamicports":[],"children":[]},{"id":"5cfc6bd5-279d-b8b9-c1f5-678e04071ac2","type":"Group","parameters":{"flexDirection":"row","sizeMode":"contentHeight","alignItems":"center","marginTop":{"value":16,"unit":"px"},"columnGap":{"value":16,"unit":"px"}},"ports":[],"dynamicports":[],"children":[{"id":"f41be625-10ff-0a40-e2dc-817f637b6521","type":"net.noodl.controls.button","parameters":{"label":"Cancel"},"ports":[],"dynamicports":[],"children":[]}]}]}]},{"id":"0c102115-9ec1-d592-e5a3-aaf497d54a2b","type":"PageInputs","x":-317.25683817239747,"y":-240.8420108230763,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"9569c72a-46df-3051-b201-2e9eada50240","type":"/Firebase/Password Reset/Firebase - Send Password Reset","x":134.38252237779335,"y":-41.75377275130927,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"7850d63b-5ec6-dfb2-763b-0779a781a2d6","type":"NavigationShowPopup","label":"Show Reset Pwd Emailed Popup","x":331.07031709871876,"y":-41.242422693890774,"parameters":{"target":"/Firebase/Password Reset/Firebase - Sent Pwd Reset Email Popup"},"ports":[],"dynamicports":[{"name":"popupParam-email","displayName":"email","type":"string","plug":"input","group":"Params","index":3}],"children":[]},{"id":"6126a77c-12a6-f473-c83d-6e6cb748f772","type":"Switch","x":135.40337891993852,"y":172.64467699978786,"parameters":{},"ports":[],"dynamicports":[],"children":[]}],"visualRoots":["4e769551-9d39-2ee2-54bc-7b67669d6003"]}},{"name":"/Firebase/Start Page","id":"69559017-a17f-333b-c101-fbb0d1b4ce31","graph":{"connections":[],"roots":[{"id":"a4b7e4d4-c01d-1267-30b6-c2b448b90067","type":"Page","x":0,"y":0,"parameters":{"title":"Landing when signed-in"},"ports":[],"dynamicports":[{"name":"title","displayName":"Title","type":"string","group":"General","plug":"input","default":"Start Page","index":31},{"name":"urlPath","displayName":"Url Path","type":"string","group":"General","plug":"input","default":"landing-when-signed-in","index":32}],"children":[]},{"id":"10fa011a-db2f-e573-47e6-ed69e091fbc1","type":"PageInputs","x":-248,"y":-2,"parameters":{},"ports":[],"dynamicports":[],"children":[]}],"visualRoots":["a4b7e4d4-c01d-1267-30b6-c2b448b90067"]}},{"name":"/Firebase/User Auth/Sign-out","id":"7e903bd6-dc28-7476-1420-5ac8b37102ac","graph":{"connections":[{"fromId":"f65f1de5-a6d8-bcd3-3054-622ec3e6ea13","fromProperty":"onClick","toId":"05a7a883-6880-765b-ad91-8eef4f0ac998","toProperty":"Do"},{"fromId":"05a7a883-6880-765b-ad91-8eef4f0ac998","fromProperty":"Success","toId":"96f30f70-82b3-08bb-3ac8-d08d7cfe5bd8","toProperty":"navigate"}],"roots":[{"id":"7bc418a0-3de3-7b4f-e551-6e8a5752aaf9","type":"Page","x":0,"y":0,"parameters":{},"ports":[],"dynamicports":[{"name":"title","displayName":"Title","type":"string","group":"General","plug":"input","default":"Sign-out","index":31},{"name":"urlPath","displayName":"Url Path","type":"string","group":"General","plug":"input","default":"sign-out","index":32}],"children":[{"id":"e365ced4-46cb-ee2c-cd5d-f4f00c928d43","type":"Group","parameters":{"marginTop":{"value":24,"unit":"px"},"marginLeft":{"value":24,"unit":"px"}},"ports":[],"dynamicports":[],"children":[{"id":"f65f1de5-a6d8-bcd3-3054-622ec3e6ea13","type":"net.noodl.controls.button","parameters":{"label":"Sign out"},"ports":[],"dynamicports":[],"children":[]}]}]},{"id":"40cb0116-7fab-e645-6e7e-3dee35dc4f03","type":"PageInputs","x":-100,"y":-50,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"96f30f70-82b3-08bb-3ac8-d08d7cfe5bd8","type":"RouterNavigate","x":522.2222222222222,"y":96.66666666666669,"parameters":{"router":"Firebase Main","target":"/Firebase/User Auth/SignUp-SignIn with Firebase Eml & Pwd"},"ports":[],"dynamicports":[{"plug":"input","type":{"name":"enum","enums":[{"label":"Supabase Not Logged In Router","value":"Supabase Not Logged In Router"},{"label":"Supabase Logged In Router","value":"Supabase Logged In Router"},{"label":"Firebase Main","value":"Firebase Main"}],"allowEditOnly":true},"group":"General","displayName":"Router","name":"router","index":3},{"plug":"input","type":{"name":"component","title":"Choose page component","components":["/Firebase/Start Page","/Firebase/User Auth/SignUp-SignIn with Firebase Eml & Pwd","/Firebase/Password Reset/Reset Firebase Password","/Firebase/Verify & Update Email/Update Firebase Email","/Firebase/User Auth/Sign-out","/Firebase/Delete Account/Delete Account"],"allowEditOnly":true},"group":"General","displayName":"Target Page","name":"target","index":4}],"children":[]},{"id":"05a7a883-6880-765b-ad91-8eef4f0ac998","type":"/Firebase/User Auth/Sign-out/Firebase - User Sign-Out","x":283.7222222222222,"y":87.66666666666669,"parameters":{},"ports":[],"dynamicports":[],"children":[]}],"visualRoots":["7bc418a0-3de3-7b4f-e551-6e8a5752aaf9"]}},{"name":"/Firebase/User Auth/Sign-out/Firebase - User Sign-Out","id":"c476bea7-bae3-1fc1-856b-2d20f6133dd8","graph":{"connections":[{"fromId":"519c7c50-5605-bf6f-b883-f28d9d2a34f8","fromProperty":"Do","toId":"3f57786a-e516-35a5-0192-1354c116a2e0","toProperty":"run"},{"fromId":"3f57786a-e516-35a5-0192-1354c116a2e0","fromProperty":"out-Success","toId":"eceb7663-cbf3-2f9c-5c50-5411f9184cdc","toProperty":"Success"},{"fromId":"3f57786a-e516-35a5-0192-1354c116a2e0","fromProperty":"out-Failure","toId":"eceb7663-cbf3-2f9c-5c50-5411f9184cdc","toProperty":"Failure"}],"roots":[{"id":"519c7c50-5605-bf6f-b883-f28d9d2a34f8","type":"Component Inputs","x":230,"y":193,"parameters":{},"ports":[{"name":"Do","plug":"output","type":{"name":"*"},"index":1}],"dynamicports":[],"children":[]},{"id":"3f57786a-e516-35a5-0192-1354c116a2e0","type":"JavaScriptFunction","x":441,"y":188,"parameters":{"functionScript":"if (Boolean(Noodl.Variables.firebaseAuth)) {\r\n  Noodl.Variables.firebaseAuth.signOut().then(() => {\r\n    console.log(\"User signed out successfully.\");\r\n    Outputs.Success();\r\n    // Update the UI or perform other actions post-sign-out\r\n    // For example, resetting user-related variables or navigating to the login screen\r\n  }).catch((error) => {\r\n    console.error(\"Sign out error:\", error);\r\n    // Handle any errors that occur during sign out\r\n    Outputs.Failure();\r\n  });\r\n} else {\r\n  console.error(\"Firebase Auth is not configured or initialized!\");\r\n}","scriptOutputs":[{"id":"crhc","label":"Success"}],"outtype-Success":"signal"},"ports":[],"dynamicports":[{"name":"outtype-Success","displayName":"Type","editorName":"Success | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"},{"value":"signal","label":"Signal"}],"allowEditOnly":true},"default":"string","parent":"scriptOutputs","parentItemId":"crhc","index":4},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":5},{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":6}],"children":[],"metadata":{"merge":{"soureCodePorts":["functionScript"]}}},{"id":"eceb7663-cbf3-2f9c-5c50-5411f9184cdc","type":"Component Outputs","x":677.6666666666666,"y":192,"parameters":{},"ports":[{"name":"Success","plug":"input","type":{"name":"*"},"index":1},{"name":"Failure","plug":"input","type":{"name":"*"},"index":2}],"dynamicports":[],"children":[]}],"visualRoots":[]}},{"name":"/Firebase/User Auth/SignUp-SignIn with Firebase Eml & Pwd","id":"fcc77789-f529-8182-1bb4-cdde9a79c335","graph":{"connections":[{"fromId":"8636d35d-084e-8cdc-43bd-0a2ce9eca7d8","fromProperty":"onTextChanged","toId":"29bf3bbd-c499-bbe5-03db-f7e212af03cc","toProperty":"email"},{"fromId":"533b071a-293e-2e7c-d803-f05677065776","fromProperty":"onTextChanged","toId":"29bf3bbd-c499-bbe5-03db-f7e212af03cc","toProperty":"password"},{"fromId":"29bf3bbd-c499-bbe5-03db-f7e212af03cc","fromProperty":"Success","toId":"94a2aef0-4a06-4ec5-a99c-bc1592bf66e5","toProperty":"Do"},{"fromId":"29bf3bbd-c499-bbe5-03db-f7e212af03cc","fromProperty":"Success","toId":"8636d35d-084e-8cdc-43bd-0a2ce9eca7d8","toProperty":"clear"},{"fromId":"29bf3bbd-c499-bbe5-03db-f7e212af03cc","fromProperty":"Success","toId":"533b071a-293e-2e7c-d803-f05677065776","toProperty":"clear"},{"fromId":"94a2aef0-4a06-4ec5-a99c-bc1592bf66e5","fromProperty":"Success","toId":"cdd525ca-0387-330a-c825-1f10ae658d8c","toProperty":"show"},{"fromId":"95ec91c3-70b7-98d5-f65c-21c9a8d15c4a","fromProperty":"onClick","toId":"29bf3bbd-c499-bbe5-03db-f7e212af03cc","toProperty":"Do"},{"fromId":"29bf3bbd-c499-bbe5-03db-f7e212af03cc","fromProperty":"error","toId":"083ec5ee-124e-f1da-82a7-85dce6fce8a9","toProperty":"text"},{"fromId":"57296387-1b34-ecde-2d9a-a47670fa0729","fromProperty":"onClick","toId":"5ef7d2be-2714-8701-8b38-237ad1931979","toProperty":"Do"},{"fromId":"8636d35d-084e-8cdc-43bd-0a2ce9eca7d8","fromProperty":"onTextChanged","toId":"5ef7d2be-2714-8701-8b38-237ad1931979","toProperty":"email"},{"fromId":"533b071a-293e-2e7c-d803-f05677065776","fromProperty":"onTextChanged","toId":"5ef7d2be-2714-8701-8b38-237ad1931979","toProperty":"password"},{"fromId":"5ef7d2be-2714-8701-8b38-237ad1931979","fromProperty":"error","toId":"083ec5ee-124e-f1da-82a7-85dce6fce8a9","toProperty":"text"},{"fromId":"0f424cea-379a-18c6-f6dc-dcd9165274e1","fromProperty":"onClick","toId":"1981fccb-1aca-bea2-3dc4-602b6db20774","toProperty":"Do"},{"fromId":"1981fccb-1aca-bea2-3dc4-602b6db20774","fromProperty":"Success","toId":"f5c58de6-0926-2408-d064-e9b3a2336ee8","toProperty":"show"},{"fromId":"5ef7d2be-2714-8701-8b38-237ad1931979","fromProperty":"Success","toId":"e17c0022-6a85-4141-ed67-800b08f29e31","toProperty":"Do"},{"fromId":"5ef7d2be-2714-8701-8b38-237ad1931979","fromProperty":"showAlert","toId":"083ec5ee-124e-f1da-82a7-85dce6fce8a9","toProperty":"mounted"},{"fromId":"5ef7d2be-2714-8701-8b38-237ad1931979","fromProperty":"isNotVerified","toId":"0f424cea-379a-18c6-f6dc-dcd9165274e1","toProperty":"mounted"}],"roots":[{"id":"6a92ca43-ffff-5c5d-0613-4ed255d62735","type":"Page","x":0,"y":0,"parameters":{"urlPath":"user-auth"},"ports":[],"dynamicports":[{"name":"title","displayName":"Title","type":"string","group":"General","plug":"input","default":"SignUp-SignIn with Firebase Eml & Pwd","index":31},{"name":"urlPath","displayName":"Url Path","type":"string","group":"General","plug":"input","default":"signup-signin-with-firebase-eml-&-pwd","index":32}],"children":[{"id":"b25744e8-36da-8e7e-11df-46b0fbca86e1","type":"Group","label":"User Form","parameters":{"flexDirection":"column","backgroundColor":"#FFFFFF","borderRadius":{"value":8,"unit":"px"},"sizeMode":"contentHeight","clip":true},"ports":[],"dynamicports":[],"children":[{"id":"5bcf25a9-574b-6481-1f73-65dbd81e8736","type":"Text","label":"","parameters":{"text":"Create account or log in","marginBottom":{"value":16,"unit":"px"}},"ports":[],"dynamicports":[],"children":[]},{"id":"8636d35d-084e-8cdc-43bd-0a2ce9eca7d8","type":"net.noodl.controls.textinput","label":"Email Input","parameters":{"label":"","type":"email","placeholder":"Email","marginBottom":{"value":8,"unit":"px"}},"ports":[],"dynamicports":[],"children":[]},{"id":"083ec5ee-124e-f1da-82a7-85dce6fce8a9","type":"Text","label":"Error alert","parameters":{"text":"","color":"Danger","fontSize":{"value":12,"unit":"px"}},"ports":[],"dynamicports":[],"children":[]},{"id":"0f424cea-379a-18c6-f6dc-dcd9165274e1","type":"net.noodl.controls.button","parameters":{"label":"Resend email verification","mounted":false},"ports":[],"dynamicports":[],"children":[]},{"id":"533b071a-293e-2e7c-d803-f05677065776","type":"net.noodl.controls.textinput","label":"Password Input","parameters":{"label":"","type":"password","marginBottom":{"value":16,"unit":"px"},"placeholder":"Password (6 characters min)"},"ports":[],"dynamicports":[],"children":[]},{"id":"668cda65-12bb-acc2-4b82-3508ae7b8a52","type":"Group","label":"Buttons","parameters":{"flexDirection":"row","justifyContent":"space-around"},"ports":[],"dynamicports":[],"children":[{"id":"95ec91c3-70b7-98d5-f65c-21c9a8d15c4a","type":"net.noodl.controls.button","parameters":{"label":"Sign up"},"ports":[],"dynamicports":[],"children":[]},{"id":"57296387-1b34-ecde-2d9a-a47670fa0729","type":"net.noodl.controls.button","label":"Log in","parameters":{"label":"Log in"},"ports":[],"dynamicports":[],"children":[]}]}]}]},{"id":"eff04e03-4654-d04c-a60e-516db7583f03","type":"PageInputs","x":-100,"y":-50,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"29bf3bbd-c499-bbe5-03db-f7e212af03cc","type":"/Firebase/User Auth/SignUp-SignIn with Firebase Eml & Pwd/Firebase - User Sign-up","x":477,"y":104.55555555555551,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"94a2aef0-4a06-4ec5-a99c-bc1592bf66e5","type":"/Firebase/Email Verification/Firebase - Send Email Verification","x":685.0833333333333,"y":110.26851851851859,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"cdd525ca-0387-330a-c825-1f10ae658d8c","type":"NavigationShowPopup","label":"Confirm Sent","x":876.95,"y":109.8685185185185,"parameters":{"target":"/Firebase/Email Verification/Firebase - Sent Email Verif Popup"},"ports":[],"dynamicports":[],"children":[]},{"id":"5ef7d2be-2714-8701-8b38-237ad1931979","type":"/Firebase/User Auth/SignUp-SignIn with Firebase Eml & Pwd/Firebase - User Sign-in","x":561.9825396825396,"y":507.1204585537919,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"1981fccb-1aca-bea2-3dc4-602b6db20774","type":"/Firebase/Email Verification/Firebase - Send Email Verification","x":-159.44633408919123,"y":392.3599983203158,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"f5c58de6-0926-2408-d064-e9b3a2336ee8","type":"NavigationShowPopup","label":"Confirm Sent","x":-349,"y":393,"parameters":{"target":"/Firebase/Email Verification/Firebase - Sent Email Verif Popup"},"ports":[],"dynamicports":[],"children":[]},{"id":"e17c0022-6a85-4141-ed67-800b08f29e31","type":"/Firebase/Firebase - Get Current User","x":783.1588141429411,"y":505.9866651736141,"parameters":{},"ports":[],"dynamicports":[],"children":[]}],"visualRoots":["6a92ca43-ffff-5c5d-0613-4ed255d62735"],"comments":[{"text":"For augmented email validation UX\ncheck the SignUp example page","width":260,"height":68,"fill":"transparent","x":530,"y":345,"id":"19638ebc-8fab-674d-f88e-9d4c435e4cfe","largeFont":false}]}},{"name":"/Firebase/User Auth/SignUp-SignIn with Firebase Eml & Pwd/Email Format Validator","id":"83dd1bcb-f4fa-6945-02fc-47395c71d069","graph":{"connections":[{"fromId":"a1c06355-89d7-ef8c-4d2d-0817a4e1657b","fromProperty":"out-isValid","toId":"c0985ad8-ee64-de2c-510f-c09e167df196","toProperty":"condition"},{"fromId":"89278e7f-3ccc-5213-d93c-5bf3a80fe946","fromProperty":"email","toId":"a1c06355-89d7-ef8c-4d2d-0817a4e1657b","toProperty":"in-email"},{"fromId":"89278e7f-3ccc-5213-d93c-5bf3a80fe946","fromProperty":"Do","toId":"a1c06355-89d7-ef8c-4d2d-0817a4e1657b","toProperty":"run"},{"fromId":"c0985ad8-ee64-de2c-510f-c09e167df196","fromProperty":"ontrue","toId":"817d5527-1057-0c92-431f-1c7c72271e27","toProperty":"valid"},{"fromId":"c0985ad8-ee64-de2c-510f-c09e167df196","fromProperty":"onfalse","toId":"817d5527-1057-0c92-431f-1c7c72271e27","toProperty":"invalid"},{"fromId":"a1c06355-89d7-ef8c-4d2d-0817a4e1657b","fromProperty":"out-Failure","toId":"817d5527-1057-0c92-431f-1c7c72271e27","toProperty":"Failure"}],"roots":[{"id":"89278e7f-3ccc-5213-d93c-5bf3a80fe946","type":"Component Inputs","x":98,"y":-169,"parameters":{},"ports":[{"name":"Do","plug":"output","type":"*","index":0},{"name":"email","plug":"output","type":{"name":"*"},"index":1}],"dynamicports":[],"children":[]},{"id":"817d5527-1057-0c92-431f-1c7c72271e27","type":"Component Outputs","x":733,"y":-188,"parameters":{},"ports":[{"name":"Success","plug":"input","type":"*","index":0},{"name":"Failure","plug":"input","type":"*","index":1},{"name":"valid","plug":"input","type":{"name":"*"},"index":2},{"name":"invalid","plug":"input","type":{"name":"*"},"index":3}],"dynamicports":[],"children":[]},{"id":"a1c06355-89d7-ef8c-4d2d-0817a4e1657b","type":"JavaScriptFunction","label":"Function email validator","x":303,"y":-195,"parameters":{"functionScript":"const email = Inputs.email;\r\n\r\nif (window.validator && window.validator.isEmail(email)) {\r\n    console.log(\"The email address is valid.\");\r\n    Outputs.isValid = true;\r\n} else {\r\n    console.log(\"The email address is invalid.\");\r\n    Outputs.isValid = false;\r\n    Outputs.Failure();\r\n}\r\n\r\n// Signal the completion of the operation\r\nOutputs.Done();"},"ports":[],"dynamicports":[{"name":"in-email","displayName":"email","plug":"input","type":"*","group":"Inputs","index":4},{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":5},{"name":"out-Done","displayName":"Done","plug":"output","type":"signal","group":"Outputs","index":6},{"name":"out-isValid","displayName":"isValid","plug":"output","type":"*","group":"Outputs","index":7}],"children":[],"metadata":{"merge":{"soureCodePorts":["functionScript"]}}},{"id":"c0985ad8-ee64-de2c-510f-c09e167df196","type":"Condition","x":517,"y":-109,"parameters":{},"ports":[],"dynamicports":[],"children":[]}],"visualRoots":[]}},{"name":"/Firebase/User Auth/SignUp-SignIn with Firebase Eml & Pwd/Firebase - User Sign-in","id":"3c3e556c-32c5-2743-d21c-f684604ade00","graph":{"connections":[{"fromId":"83e232a4-02d1-5a74-9893-b02811bc3248","fromProperty":"email","toId":"9aa078d3-5fac-ca86-d84f-9f7962ced00f","toProperty":"in-email"},{"fromId":"83e232a4-02d1-5a74-9893-b02811bc3248","fromProperty":"password","toId":"9aa078d3-5fac-ca86-d84f-9f7962ced00f","toProperty":"in-password"},{"fromId":"9aa078d3-5fac-ca86-d84f-9f7962ced00f","fromProperty":"out-Failure","toId":"06cf31fd-6518-5f23-ebef-264269fc3ae6","toProperty":"Failure"},{"fromId":"9aa078d3-5fac-ca86-d84f-9f7962ced00f","fromProperty":"out-Success","toId":"06cf31fd-6518-5f23-ebef-264269fc3ae6","toProperty":"Success"},{"fromId":"9aa078d3-5fac-ca86-d84f-9f7962ced00f","fromProperty":"out-error","toId":"06cf31fd-6518-5f23-ebef-264269fc3ae6","toProperty":"error"},{"fromId":"9aa078d3-5fac-ca86-d84f-9f7962ced00f","fromProperty":"out-loggedIn","toId":"06cf31fd-6518-5f23-ebef-264269fc3ae6","toProperty":"loggedIn"},{"fromId":"83e232a4-02d1-5a74-9893-b02811bc3248","fromProperty":"Do","toId":"9aa078d3-5fac-ca86-d84f-9f7962ced00f","toProperty":"run"},{"fromId":"9aa078d3-5fac-ca86-d84f-9f7962ced00f","fromProperty":"out-isNotVerified","toId":"06cf31fd-6518-5f23-ebef-264269fc3ae6","toProperty":"isNotVerified"},{"fromId":"9aa078d3-5fac-ca86-d84f-9f7962ced00f","fromProperty":"out-showAlert","toId":"06cf31fd-6518-5f23-ebef-264269fc3ae6","toProperty":"showAlert"}],"roots":[{"id":"83e232a4-02d1-5a74-9893-b02811bc3248","type":"Component Inputs","x":-137,"y":-192,"parameters":{},"ports":[{"name":"Do","plug":"output","type":"*","index":0},{"name":"email","plug":"output","type":{"name":"*"},"index":1},{"name":"password","plug":"output","type":{"name":"*"},"index":2}],"dynamicports":[],"children":[]},{"id":"06cf31fd-6518-5f23-ebef-264269fc3ae6","type":"Component Outputs","x":327,"y":-193,"parameters":{},"ports":[{"name":"Success","plug":"input","type":"*","index":0},{"name":"Failure","plug":"input","type":"*","index":1},{"name":"error","plug":"input","type":{"name":"*"},"index":3},{"name":"loggedIn","plug":"input","type":{"name":"*"},"index":4},{"name":"isNotVerified","plug":"input","type":{"name":"*"},"index":5},{"name":"showAlert","plug":"input","type":{"name":"*"},"index":6}],"dynamicports":[],"children":[]},{"id":"9aa078d3-5fac-ca86-d84f-9f7962ced00f","type":"JavaScriptFunction","label":"signIn With Email And Password","x":97,"y":-217.33333333333331,"parameters":{"functionScript":"if (!Boolean(Noodl.Variables.firebaseAuth)) {\r\n    console.error(\"Firebase Auth is not configured!\");\r\n    Outputs.error = \"Firebase Auth is not configured\";\r\n    Outputs.Failure();\r\n    return; // Stops the function if Firebase Auth is not initialized\r\n}\r\n\r\n// Retrieve the email and password from Noodl inputs\r\nconst email = Inputs.email;\r\nconst password = Inputs.password;\r\n\r\nconsole.log(\"Attempting to sign in with email: \", email);\r\n\r\nif (email && password) {\r\n    // Use the globally available signInWithEmailAndPassword function for signing in\r\n    window.signInWithEmailAndPassword(Noodl.Variables.firebaseAuth, email, password)\r\n        .then((userCredential) => {\r\n            const user = userCredential.user;\r\n            console.log(`User signed in successfully, emailVerified: ${user.emailVerified}`);\r\n\r\n            // Update the currentUser object in Noodl.Objects\r\n            Noodl.Objects.currentUser = {\r\n                uid: user.uid,\r\n                email: user.email,\r\n                emailVerified: user.emailVerified,\r\n                refreshToken: user.refreshToken,\r\n                // providerData and other fields will be populated by onAuthStateChanged (get currenUser)\r\n            };\r\n            Outputs.loggedIn = true; // User is logged in regardless of email verif status to enable the sendEmailVerification function\r\n            Outputs.Success();\r\n            if (!user.emailVerified) {\r\n                Outputs.error = \"Email not verified. Please check the email verification link sent to you during sign-up, or request a new link below.\";\r\n                Outputs.isNotVerified = true; // Signal for triggering sendEmailVerification button\r\n                console.log(\"User email not verified\");\r\n            } else {\r\n                Outputs.isNotVerified = false;\r\n                console.log(\"User email verified\");\r\n            }\r\n            Outputs.Success();\r\n        })\r\n        .catch((error) => {\r\n            console.error(\"Error signing in: \", error.code, error.message);\r\n            console.log(`Error details - code: ${error.code}, message: ${error.message}`);\r\n            Outputs.showAlert = true;\r\n\r\n// It is recommended to enable Email Enumeration Protection:\r\n// https://cloud.google.com/identity-platform/docs/admin/email-enumeration-protection#overview\r\n// This protection lets the API be intentionally vague about the inputs issue, making it harder for attackers to figure out any user's account credential.\r\n\r\n            // Handle errors with Outputs.error\r\n            let errorMessage;\r\n            switch (error.code) {\r\n                case \"auth/user-not-found\": // This error msg will only fire if Email Enumeration Protection is disabled\r\n                    errorMessage = \"Sign-in failed\"; // No \"User not found\" as explicit message to prevent attackers from determining whether an email is associated with an account\r\n                    break;\r\n                case \"auth/wrong-password\": // This error msg will only fire if Email Enumeration Protection is disabled\r\n                    errorMessage = \"Wrong password\";\r\n                    break;\r\n                case \"auth/invalid-email\": // This error msg will only fire if Email Enumeration Protection is disabled\r\n                    errorMessage = \"Invalid email address format, it may be missing the @ symbol, the domain, or having invalid characters in the email portion\";\r\n                    break;\r\n                case \"auth/invalid-credential\":\r\n                    errorMessage = \"Invalid credential, please verify your inputs\";\r\n                    break;\r\n                case \"auth/too-many-requests\":\r\n                    errorMessage = \"Sign-in blocked, too many requests. You can immediately restore it by resetting your password or you can try again later.\";\r\n                    break;\r\n                default:\r\n                    errorMessage = \"Sign-in failed\";\r\n            }\r\n            console.log(\"Firebase error:\", errorMessage, error.code); // Debug: Ensure this logs correctly\r\n            Outputs.error = errorMessage;\r\n            Outputs.loggedIn = false;\r\n            Outputs.showAlert = true;\r\n            Outputs.Failure();\r\n        });\r\n} else {\r\n    console.log(\"Email and password are required.\");\r\n    Outputs.error = \"Email and password are required\";\r\n    Outputs.showAlert = true;\r\n    Outputs.Failure();\r\n}"},"ports":[],"dynamicports":[{"name":"in-email","displayName":"email","plug":"input","type":"*","group":"Inputs","index":4},{"name":"in-password","displayName":"password","plug":"input","type":"*","group":"Inputs","index":5},{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":6},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":7},{"name":"out-error","displayName":"error","plug":"output","type":"*","group":"Outputs","index":8},{"name":"out-loggedIn","displayName":"loggedIn","plug":"output","type":"*","group":"Outputs","index":9},{"name":"out-isNotVerified","displayName":"isNotVerified","plug":"output","type":"*","group":"Outputs","index":10},{"name":"out-showAlert","displayName":"showAlert","plug":"output","type":"*","group":"Outputs","index":11}],"children":[],"metadata":{"merge":{"soureCodePorts":["functionScript"]}}}],"visualRoots":[]}},{"name":"/Firebase/User Auth/SignUp-SignIn with Firebase Eml & Pwd/Firebase - User Sign-up","id":"b4d9b139-0488-ae01-6e40-998adf6e0405","graph":{"connections":[{"fromId":"eeb479d9-7a1e-f091-2996-1a246f88734b","fromProperty":"out-Success","toId":"a2aa1570-93e6-9478-6103-6728a9659397","toProperty":"Success"},{"fromId":"4ef4278e-2c61-d985-9298-fb6b6d166886","fromProperty":"email","toId":"eeb479d9-7a1e-f091-2996-1a246f88734b","toProperty":"in-email"},{"fromId":"4ef4278e-2c61-d985-9298-fb6b6d166886","fromProperty":"password","toId":"eeb479d9-7a1e-f091-2996-1a246f88734b","toProperty":"in-password"},{"fromId":"4ef4278e-2c61-d985-9298-fb6b6d166886","fromProperty":"Do","toId":"eeb479d9-7a1e-f091-2996-1a246f88734b","toProperty":"run"},{"fromId":"eeb479d9-7a1e-f091-2996-1a246f88734b","fromProperty":"out-Failure","toId":"a2aa1570-93e6-9478-6103-6728a9659397","toProperty":"Failure"},{"fromId":"eeb479d9-7a1e-f091-2996-1a246f88734b","fromProperty":"out-error","toId":"a2aa1570-93e6-9478-6103-6728a9659397","toProperty":"error"}],"roots":[{"id":"4ef4278e-2c61-d985-9298-fb6b6d166886","type":"Component Inputs","x":-146,"y":-188,"parameters":{},"ports":[{"name":"Do","plug":"output","type":"*","index":0},{"name":"email","plug":"output","type":{"name":"*"},"index":1},{"name":"password","plug":"output","type":{"name":"*"},"index":2}],"dynamicports":[],"children":[]},{"id":"a2aa1570-93e6-9478-6103-6728a9659397","type":"Component Outputs","x":407,"y":-218,"parameters":{},"ports":[{"name":"Success","plug":"input","type":"*","index":0},{"name":"Failure","plug":"input","type":"*","index":1},{"name":"error","plug":"input","type":{"name":"*"},"index":2}],"dynamicports":[],"children":[]},{"id":"eeb479d9-7a1e-f091-2996-1a246f88734b","type":"JavaScriptFunction","label":"createUser","x":97,"y":-217.33333333333331,"parameters":{"functionScript":"if (!Boolean(Noodl.Variables.firebaseAuth)) {\r\n    console.error(\"Firebase Auth is not configured!\");\r\n    Outputs.error = \"Firebase Auth is not configured\";\r\n    Outputs.Failure();\r\n    return; // Stops the function if Firebase Auth is not initialized\r\n}\r\n\r\nwindow.createUserWithEmailAndPassword(Noodl.Variables.firebaseAuth, Inputs.email, Inputs.password)\r\n    .then((userCredential) => {\r\n        console.log(\"User signed up\");\r\n        Outputs.Success();\r\n    })\r\n    .catch((error) => {\r\n        console.error(\"Error signing up: \", error.code, error.message);\r\n        console.log(\"Caught error code:\", error.code); // Log the error code\r\n\r\n        switch (error.code) {\r\n            case \"auth/email-already-in-use\":\r\n                Outputs.error = \"Email already in use - please use another one\";\r\n                break;\r\n            case \"auth/invalid-email\":\r\n                Outputs.error = \"Invalid email address format, it may be missing the @ symbol, the domain, or having invalid characters in the email portion\";\r\n                break;\r\n            case \"auth/weak-password\":\r\n                Outputs.error = \"Password too weak\";\r\n                break;\r\n            case \"auth/missing-password\":\r\n                Outputs.error = \"Password missing\";\r\n                break;\r\n            default:\r\n                Outputs.error = \"An error occurred during sign up.\";\r\n        }\r\n        Outputs.Failure();\r\n    });","scriptInputs":[{"id":"0gjw","label":"email"},{"id":"bygp","label":"password"}]},"ports":[],"dynamicports":[{"name":"intype-email","displayName":"Type","editorName":"email | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"}],"allowEditOnly":true},"default":"string","parent":"scriptInputs","parentItemId":"0gjw","index":4},{"name":"in-email","displayName":"email","plug":"input","type":"string","group":"Inputs","index":5},{"name":"intype-password","displayName":"Type","editorName":"password | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"}],"allowEditOnly":true},"default":"string","parent":"scriptInputs","parentItemId":"bygp","index":6},{"name":"in-password","displayName":"password","plug":"input","type":"string","group":"Inputs","index":7},{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":8},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":9},{"name":"out-error","displayName":"error","plug":"output","type":"*","group":"Outputs","index":10}],"children":[],"metadata":{"merge":{"soureCodePorts":["functionScript"]}}}],"visualRoots":[]}},{"name":"/Firebase/User Auth/SignUp-SignIn with Firebase Eml & Pwd/SignUp example with Email Validator","id":"85aa22c5-7613-f6d6-99d9-d90c516a7e33","graph":{"connections":[{"fromId":"71852757-aa3a-1db3-8bf0-3444115e13bb","fromProperty":"onTextChanged","toId":"877fb555-33a7-a5e7-86f1-9210aae85d6e","toProperty":"email"},{"fromId":"b1b8254f-d250-a654-8d18-b025d0ac1a6f","fromProperty":"onTextChanged","toId":"877fb555-33a7-a5e7-86f1-9210aae85d6e","toProperty":"password"},{"fromId":"877fb555-33a7-a5e7-86f1-9210aae85d6e","fromProperty":"Success","toId":"55505e35-bf91-ad7a-9b17-ed2d2e89ab04","toProperty":"Do"},{"fromId":"877fb555-33a7-a5e7-86f1-9210aae85d6e","fromProperty":"Success","toId":"71852757-aa3a-1db3-8bf0-3444115e13bb","toProperty":"clear"},{"fromId":"877fb555-33a7-a5e7-86f1-9210aae85d6e","fromProperty":"Success","toId":"b1b8254f-d250-a654-8d18-b025d0ac1a6f","toProperty":"clear"},{"fromId":"55505e35-bf91-ad7a-9b17-ed2d2e89ab04","fromProperty":"Success","toId":"bd7b5178-1a36-d2bd-a0f0-3f79ea26c5ff","toProperty":"show"},{"fromId":"500f8d95-1cc8-715c-7fbc-db21760345c4","fromProperty":"state","toId":"51897bca-3cce-02ff-b6f6-e2d14eb0179e","toProperty":"mounted"},{"fromId":"71852757-aa3a-1db3-8bf0-3444115e13bb","fromProperty":"onTextChanged","toId":"f0ea9b6c-0e86-53ba-3628-656c58cebd54","toProperty":"email"},{"fromId":"9e68c67e-fc71-9f10-7ebb-6b36615b9558","fromProperty":"onClick","toId":"f0ea9b6c-0e86-53ba-3628-656c58cebd54","toProperty":"Do"},{"fromId":"f0ea9b6c-0e86-53ba-3628-656c58cebd54","fromProperty":"valid","toId":"877fb555-33a7-a5e7-86f1-9210aae85d6e","toProperty":"Do"},{"fromId":"f0ea9b6c-0e86-53ba-3628-656c58cebd54","fromProperty":"invalid","toId":"500f8d95-1cc8-715c-7fbc-db21760345c4","toProperty":"on"}],"roots":[{"id":"e1a2603d-c9e8-5fa0-6b91-1ca2eec43be6","type":"Page","x":0,"y":0,"parameters":{"urlPath":"sign-up"},"ports":[],"dynamicports":[{"name":"title","displayName":"Title","type":"string","group":"General","plug":"input","default":"SignUp example with Email Validator","index":31},{"name":"urlPath","displayName":"Url Path","type":"string","group":"General","plug":"input","default":"signup-example-with-email-validator","index":32}],"children":[{"id":"f661edab-9be6-c071-cc41-54aadd6931b2","type":"Group","label":"User Form","parameters":{"flexDirection":"column","backgroundColor":"#FFFFFF","borderRadius":{"value":8,"unit":"px"},"sizeMode":"contentHeight","clip":true},"ports":[],"dynamicports":[],"children":[{"id":"6b9c68f8-8a4a-979b-fa50-a96703d72ffa","type":"Text","label":"","parameters":{"text":"Create account","marginBottom":{"value":16,"unit":"px"}},"ports":[],"dynamicports":[],"children":[]},{"id":"71852757-aa3a-1db3-8bf0-3444115e13bb","type":"net.noodl.controls.textinput","label":"Email Input","parameters":{"label":"","type":"email","placeholder":"Email","marginBottom":{"value":8,"unit":"px"}},"ports":[],"dynamicports":[],"children":[]},{"id":"51897bca-3cce-02ff-b6f6-e2d14eb0179e","type":"Text","parameters":{"text":"Email not valid","color":"Danger","fontSize":{"value":12,"unit":"px"}},"ports":[],"dynamicports":[],"children":[]},{"id":"b1b8254f-d250-a654-8d18-b025d0ac1a6f","type":"net.noodl.controls.textinput","label":"Password Input","parameters":{"label":"","type":"password","marginBottom":{"value":16,"unit":"px"},"placeholder":"Password (6 characters min)"},"ports":[],"dynamicports":[],"children":[]},{"id":"9e68c67e-fc71-9f10-7ebb-6b36615b9558","type":"net.noodl.controls.button","parameters":{"label":"Sign up"},"ports":[],"dynamicports":[],"children":[]},{"id":"0e0a348c-7003-6d2b-8cb9-26e61b91564e","type":"Group","parameters":{"flexDirection":"row","sizeMode":"contentHeight","alignItems":"center","marginTop":{"value":16,"unit":"px"},"columnGap":{"value":16,"unit":"px"}},"ports":[],"dynamicports":[],"children":[{"id":"6ceedc22-a62c-49d4-f26d-4f85ffff7747","type":"Text","label":"","parameters":{"text":"Already have an account?","marginTop":{"value":0,"unit":"px"},"sizeMode":"contentSize"},"ports":[],"dynamicports":[],"children":[]}]}]}]},{"id":"5d578dd6-adc7-8edd-bf1d-45ce03b7d1e8","type":"PageInputs","x":-100,"y":-50,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"877fb555-33a7-a5e7-86f1-9210aae85d6e","type":"/Firebase/User Auth/SignUp-SignIn with Firebase Eml & Pwd/Firebase - User Sign-up","x":532,"y":172.55555555555554,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"55505e35-bf91-ad7a-9b17-ed2d2e89ab04","type":"/Firebase/Email Verification/Firebase - Send Email Verification","x":747.0833333333333,"y":210.2685185185186,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"bd7b5178-1a36-d2bd-a0f0-3f79ea26c5ff","type":"NavigationShowPopup","x":937.95,"y":209.8685185185185,"parameters":{"target":"/Firebase/Email Verification/Firebase - Sent Email Verif Popup"},"ports":[],"dynamicports":[],"children":[]},{"id":"500f8d95-1cc8-715c-7fbc-db21760345c4","type":"Switch","x":532.8619047619047,"y":342.03015873015875,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"f0ea9b6c-0e86-53ba-3628-656c58cebd54","type":"/Firebase/User Auth/SignUp-SignIn with Firebase Eml & Pwd/Email Format Validator","x":302.9374149659863,"y":423.4842025699169,"parameters":{},"ports":[],"dynamicports":[],"children":[]}],"visualRoots":["e1a2603d-c9e8-5fa0-6b91-1ca2eec43be6"]}},{"name":"/Firebase/Verify & Update Email/Firebase - Updated Email Popup","id":"2035f214-4505-7b2f-b115-74b8e466cc70","graph":{"connections":[{"fromId":"64ea1a71-b99b-0ec7-fb66-603017387ea3","fromProperty":"formatted","toId":"520eba37-fdb7-0fb8-055e-c71c35d7e05d","toProperty":"text"},{"fromId":"85e09022-fabe-1ecb-2c64-16fbf9e3b899","fromProperty":"email","toId":"64ea1a71-b99b-0ec7-fb66-603017387ea3","toProperty":"email"}],"roots":[{"id":"226ef980-7a3c-5e52-bed8-1a6d7284ed4c","type":"Group","x":177,"y":0,"parameters":{"backgroundColor":"Grey - 400","justifyContent":"flex-start","paddingTop":{"value":24,"unit":"px"}},"ports":[],"dynamicports":[],"children":[{"id":"520eba37-fdb7-0fb8-055e-c71c35d7e05d","type":"Text","label":"Updated email popup","parameters":{"text":"","textAlignX":"center"},"ports":[],"dynamicports":[],"children":[]}]},{"id":"64ea1a71-b99b-0ec7-fb66-603017387ea3","type":"String Format","x":0,"y":48,"parameters":{"format":"Email address updated to {email}\n(please verify the email with the link sent to you)","userEmail":""},"ports":[],"dynamicports":[{"name":"email","type":"string","plug":"input","index":2}],"children":[]},{"id":"85e09022-fabe-1ecb-2c64-16fbf9e3b899","type":"Component Inputs","x":-217,"y":46,"parameters":{},"ports":[{"name":"email","plug":"output","type":{"name":"*"},"index":0}],"dynamicports":[],"children":[]}],"visualRoots":["226ef980-7a3c-5e52-bed8-1a6d7284ed4c"]}},{"name":"/Firebase/Verify & Update Email/Firebase - Verif & Upd Email","id":"bc777331-589d-4f1a-79f3-d2b7440a8903","graph":{"connections":[{"fromId":"fd40f6cf-df58-3460-a0f9-c66fa31cdd0b","fromProperty":"email","toId":"4d8301bb-9fa7-4028-3221-723cb63cea02","toProperty":"in-email"},{"fromId":"fd40f6cf-df58-3460-a0f9-c66fa31cdd0b","fromProperty":"Do","toId":"4d8301bb-9fa7-4028-3221-723cb63cea02","toProperty":"run"},{"fromId":"4d8301bb-9fa7-4028-3221-723cb63cea02","fromProperty":"out-Failure","toId":"b6763506-2f36-ef2e-d9bf-6201f7b217b0","toProperty":"Failure"},{"fromId":"4d8301bb-9fa7-4028-3221-723cb63cea02","fromProperty":"out-Success","toId":"b6763506-2f36-ef2e-d9bf-6201f7b217b0","toProperty":"Success"},{"fromId":"4d8301bb-9fa7-4028-3221-723cb63cea02","fromProperty":"out-error","toId":"b6763506-2f36-ef2e-d9bf-6201f7b217b0","toProperty":"Error"},{"fromId":"4d8301bb-9fa7-4028-3221-723cb63cea02","fromProperty":"out-newEmail","toId":"b6763506-2f36-ef2e-d9bf-6201f7b217b0","toProperty":"newEmail"},{"fromId":"4d8301bb-9fa7-4028-3221-723cb63cea02","fromProperty":"out-requiresLogin","toId":"b6763506-2f36-ef2e-d9bf-6201f7b217b0","toProperty":"requiresLogin"},{"fromId":"4d8301bb-9fa7-4028-3221-723cb63cea02","fromProperty":"out-showAlert","toId":"b6763506-2f36-ef2e-d9bf-6201f7b217b0","toProperty":"showAlert"}],"roots":[{"id":"fd40f6cf-df58-3460-a0f9-c66fa31cdd0b","type":"Component Inputs","x":-187,"y":-97,"parameters":{},"ports":[{"name":"Do","plug":"output","type":"*","index":0},{"name":"email","plug":"output","type":{"name":"*"},"index":1}],"dynamicports":[],"children":[]},{"id":"b6763506-2f36-ef2e-d9bf-6201f7b217b0","type":"Component Outputs","x":301,"y":-110,"parameters":{},"ports":[{"name":"Success","plug":"input","type":"*","index":0},{"name":"Failure","plug":"input","type":"*","index":1},{"name":"Error","plug":"input","type":{"name":"*"},"index":2},{"name":"newEmail","plug":"input","type":{"name":"*"},"index":3},{"name":"requiresLogin","plug":"input","type":{"name":"*"},"index":4},{"name":"showAlert","plug":"input","type":{"name":"*"},"index":5}],"dynamicports":[],"children":[]},{"id":"4d8301bb-9fa7-4028-3221-723cb63cea02","type":"JavaScriptFunction","label":"verifyUpdateEmail","x":29,"y":-130.33333333333331,"parameters":{"functionScript":"if (!Boolean(Noodl.Variables.firebaseAuth)) {\r\n    console.error(\"Firebase Auth is not configured!\");\r\n    return; // Stops the function if Firebase Auth is not initialized\r\n}\r\n\r\n// Assuming Inputs.email contains the new email address to update to\r\nconst newEmail = Inputs.email;\r\n\r\nif (newEmail) {\r\n    // Use the globally available updateEmail function\r\n    window.verifyBeforeUpdateEmail(Noodl.Variables.firebaseAuth.currentUser, newEmail)\r\n        .then(() => {\r\n            console.log(\"Email updated successfully.\");\r\n            Noodl.Objects.currentUser.email = newEmail; // Update the email in Noodl.Objects.currentUser\r\n            Outputs.newEmail = newEmail; // Reflect the successful email update\r\n            Outputs.showAlert = false;\r\n            Outputs.Success();\r\n        })\r\n        .catch((error) => {\r\n            console.error(\"Error updating email: \", error.code, error.message);\r\n            // Handle specific errors with Outputs.error\r\n            switch (error.code) {\r\n                case \"auth/email-already-in-use\":\r\n                    Outputs.error = \"Email already in use\";\r\n                    break;\r\n                case \"auth/invalid-email\":\r\n                    Outputs.error = \"Email update failed.\";\r\n                    break;\r\n                case \"auth/requires-recent-login\":\r\n                    Outputs.error = \"Requires recent login. Please re-authenticate.\";\r\n                    Outputs.requiresLogin = true;\r\n                    break;\r\n                case \"auth/operation-not-allowed\":\r\n                    Outputs.error = \"Not allowed.\";\r\n                    break;\r\n                default:\r\n                    Outputs.error = \"Email update failed.\";\r\n            }\r\n            Outputs.showAlert = true;\r\n            Outputs.Failure();\r\n        });\r\n} else {\r\n    console.log(\"New email address is required.\");\r\n    Outputs.error = \"New email address is required\";\r\n    Outputs.showAlert = true;\r\n    Outputs.Failure();\r\n}"},"ports":[],"dynamicports":[{"name":"in-email","displayName":"email","plug":"input","type":"*","group":"Inputs","index":4},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":5},{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":6},{"name":"out-newEmail","displayName":"newEmail","plug":"output","type":"*","group":"Outputs","index":7},{"name":"out-showAlert","displayName":"showAlert","plug":"output","type":"*","group":"Outputs","index":8},{"name":"out-error","displayName":"error","plug":"output","type":"*","group":"Outputs","index":9},{"name":"out-requiresLogin","displayName":"requiresLogin","plug":"output","type":"*","group":"Outputs","index":10}],"children":[],"metadata":{"merge":{"soureCodePorts":["functionScript"]}}}],"visualRoots":[],"comments":[{"text":"Recent firebase security upgrade enables the Email Enumeration feature by default.\nTherefore use function verifyBeforeUpdateEmail instead of updateEmail","width":174,"height":342,"fill":"transparent","x":17,"y":-279,"id":"d3d1db4c-2bff-8877-f2ae-515aff24e392"}]}},{"name":"/Firebase/Verify & Update Email/Update Firebase Email","id":"b21e0d27-d11a-6941-6caf-1ba82b3e0932","graph":{"connections":[{"fromId":"e9b3a813-5f1f-990f-48a7-6070887f66d6","fromProperty":"onTextChanged","toId":"1f9ec74f-35d7-249d-96be-33c05bd4e1b7","toProperty":"email"},{"fromId":"1f9ec74f-35d7-249d-96be-33c05bd4e1b7","fromProperty":"Success","toId":"665eab5c-245d-5cdc-3acb-5c9e5325055b","toProperty":"show"},{"fromId":"1f9ec74f-35d7-249d-96be-33c05bd4e1b7","fromProperty":"newEmail","toId":"665eab5c-245d-5cdc-3acb-5c9e5325055b","toProperty":"popupParam-email"},{"fromId":"049dafdb-eaa7-2369-57e9-7f792c6ca68e","fromProperty":"onClick","toId":"1f9ec74f-35d7-249d-96be-33c05bd4e1b7","toProperty":"Do"},{"fromId":"1f9ec74f-35d7-249d-96be-33c05bd4e1b7","fromProperty":"Success","toId":"e9b3a813-5f1f-990f-48a7-6070887f66d6","toProperty":"clear"},{"fromId":"1f9ec74f-35d7-249d-96be-33c05bd4e1b7","fromProperty":"Error","toId":"7f2ff4b7-e529-2346-003f-413872f6fa76","toProperty":"text"},{"fromId":"c908a1dd-ccba-af4d-84cd-e49b4eb7925a","fromProperty":"didMount","toId":"90892fe4-f8f3-bda7-783c-7110f804f8be","toProperty":"Do"},{"fromId":"df5c5036-7fe2-abf6-2c39-8c38df4ae08f","fromProperty":"onTextChanged","toId":"879f34e1-aec3-d15c-2f0c-431d6e27a0af","toProperty":"in-email"},{"fromId":"1353550f-7f0c-f445-1368-59e0a5630965","fromProperty":"onTextChanged","toId":"879f34e1-aec3-d15c-2f0c-431d6e27a0af","toProperty":"in-password"},{"fromId":"fc45fbdd-64f5-d85e-ecea-ed5ef7f3cbbd","fromProperty":"onClick","toId":"879f34e1-aec3-d15c-2f0c-431d6e27a0af","toProperty":"run"},{"fromId":"879f34e1-aec3-d15c-2f0c-431d6e27a0af","fromProperty":"out-Success","toId":"1f9ec74f-35d7-249d-96be-33c05bd4e1b7","toProperty":"Do"},{"fromId":"a1849f89-cdfe-2b96-ed75-7bdca0101f70","fromProperty":"result","toId":"e9b3a813-5f1f-990f-48a7-6070887f66d6","toProperty":"mounted"},{"fromId":"a1849f89-cdfe-2b96-ed75-7bdca0101f70","fromProperty":"result","toId":"049dafdb-eaa7-2369-57e9-7f792c6ca68e","toProperty":"mounted"},{"fromId":"1f9ec74f-35d7-249d-96be-33c05bd4e1b7","fromProperty":"requiresLogin","toId":"a1849f89-cdfe-2b96-ed75-7bdca0101f70","toProperty":"value"},{"fromId":"1f9ec74f-35d7-249d-96be-33c05bd4e1b7","fromProperty":"requiresLogin","toId":"8bd6f449-9427-e443-f157-a5e59e9b120e","toProperty":"mounted"},{"fromId":"1f9ec74f-35d7-249d-96be-33c05bd4e1b7","fromProperty":"showAlert","toId":"7f2ff4b7-e529-2346-003f-413872f6fa76","toProperty":"mounted"}],"roots":[{"id":"c908a1dd-ccba-af4d-84cd-e49b4eb7925a","type":"Page","label":"Page Update Email","x":-268.25683817239747,"y":-192.8420108230763,"parameters":{},"ports":[],"dynamicports":[{"name":"title","displayName":"Title","type":"string","group":"General","plug":"input","default":"Update Firebase Email","index":31},{"name":"urlPath","displayName":"Url Path","type":"string","group":"General","plug":"input","default":"update-firebase-email","index":32}],"children":[{"id":"76bf38b9-a70e-7381-71a2-47046389e917","type":"Group","label":"Update Email form","parameters":{"flexDirection":"column","backgroundColor":"#FFFFFF","borderRadius":{"value":8,"unit":"px"},"sizeMode":"contentHeight","clip":true},"ports":[],"dynamicports":[],"children":[{"id":"7d740ba8-6b0d-b523-1e19-71562d48700d","type":"Text","label":"Update Email","parameters":{"text":"Update Email (may require re-authentication for security reasons)","marginBottom":{"value":16,"unit":"px"}},"ports":[],"dynamicports":[],"children":[]},{"id":"e9b3a813-5f1f-990f-48a7-6070887f66d6","type":"net.noodl.controls.textinput","label":"Email Update Input","parameters":{"label":"","type":"email","placeholder":"New email","marginBottom":{"value":8,"unit":"px"}},"ports":[],"dynamicports":[],"children":[]},{"id":"7f2ff4b7-e529-2346-003f-413872f6fa76","type":"Text","label":"Error alert","parameters":{"text":"","color":"Danger","fontSize":{"value":12,"unit":"px"}},"ports":[],"dynamicports":[],"children":[]},{"id":"049dafdb-eaa7-2369-57e9-7f792c6ca68e","type":"net.noodl.controls.button","parameters":{"label":"Update email"},"ports":[],"dynamicports":[],"children":[]},{"id":"8bd6f449-9427-e443-f157-a5e59e9b120e","type":"Group","label":"Eml-pwd inputs","parameters":{"mounted":false},"ports":[],"dynamicports":[],"children":[{"id":"df5c5036-7fe2-abf6-2c39-8c38df4ae08f","type":"net.noodl.controls.textinput","label":"Email Input","parameters":{"label":"","type":"email","placeholder":"Email","marginBottom":{"value":8,"unit":"px"},"useLabel":false,"mounted":true},"ports":[],"dynamicports":[],"children":[]},{"id":"1353550f-7f0c-f445-1368-59e0a5630965","type":"net.noodl.controls.textinput","label":"Password Input","parameters":{"placeholder":"Password","useLabel":false,"mounted":true},"ports":[],"dynamicports":[],"children":[]},{"id":"fc45fbdd-64f5-d85e-ecea-ed5ef7f3cbbd","type":"net.noodl.controls.button","parameters":{"label":"Authenticate","mounted":true},"ports":[],"dynamicports":[],"children":[]}]},{"id":"af10e809-94d4-d478-7c33-16a53f636b62","type":"Group","parameters":{"flexDirection":"row","sizeMode":"contentHeight","alignItems":"center","marginTop":{"value":16,"unit":"px"},"columnGap":{"value":16,"unit":"px"}},"ports":[],"dynamicports":[],"children":[{"id":"54333b12-10a7-315c-a2ea-7893da94f0d6","type":"net.noodl.controls.button","parameters":{"label":"Cancel"},"ports":[],"dynamicports":[],"children":[]}]}]}]},{"id":"61308ca9-3792-f080-72da-eee662001665","type":"PageInputs","x":-317.25683817239747,"y":-240.8420108230763,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"665eab5c-245d-5cdc-3acb-5c9e5325055b","type":"NavigationShowPopup","label":"Updated Email Popup","x":739.0703170987188,"y":226.75757730610925,"parameters":{"target":"/Firebase/Verify & Update Email/Firebase - Updated Email Popup"},"ports":[],"dynamicports":[{"name":"popupParam-email","displayName":"email","type":"string","plug":"input","group":"Params","index":3}],"children":[]},{"id":"1f9ec74f-35d7-249d-96be-33c05bd4e1b7","type":"/Firebase/Verify & Update Email/Firebase - Verif & Upd Email","x":522.7191683936228,"y":238.69146062551886,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"879f34e1-aec3-d15c-2f0c-431d6e27a0af","type":"JavaScriptFunction","label":"reauthenticateWithCredential","x":89.21856181058621,"y":488.8052584861023,"parameters":{"functionScript":"if (!Boolean(Noodl.Variables.firebaseAuth)) {\r\n    console.error(\"Firebase Auth is not configured!\");\r\n    Outputs.Failure();\r\n    return; // Stops the function if Firebase Auth is not initialized\r\n}\r\n\r\nconst user = Noodl.Variables.firebaseAuth.currentUser;\r\nconst email = Inputs.email;\r\nconst password = Inputs.password;\r\n\r\n// Re-authenticate user by using the reauthenticateWithCredential method on the user object\r\nif (user) {\r\n    const credential = window.EmailAuthProvider.credential(email, password);\r\n    window.reauthenticateWithCredential(user, credential).then(() => {\r\n        console.log(\"User re-authenticated.\");\r\n        Outputs.Success();\r\n    }).catch((error) => {\r\n        console.error(\"Error re-authenticating user: \", error);\r\n        switch (error.code) {\r\n            case \"auth/user-mismatch\":\r\n                Outputs.error = \"The provided credentials do not match the logged-in user.\";\r\n                break;\r\n            case \"auth/user-not-found\":\r\n                Outputs.error = \"No user corresponding to the provided credentials could be found.\";\r\n                break;\r\n            case \"auth/invalid-credential\":\r\n                Outputs.error = \"The provided credential is invalid.\";\r\n                break;\r\n            case \"auth/invalid-email\":\r\n                Outputs.error = \"The email address is not valid.\";\r\n                break;\r\n            case \"auth/wrong-password\":\r\n                Outputs.error = \"Wrong password.\";\r\n                break;\r\n            default:\r\n                Outputs.error = \"An error occurred during re-authentication.\";\r\n        }\r\n        Outputs.Failure();\r\n    });\r\n} else {\r\n    console.log(\"No user is currently signed in.\");\r\n}"},"ports":[],"dynamicports":[{"name":"in-email","displayName":"email","plug":"input","type":"*","group":"Inputs","index":4},{"name":"in-password","displayName":"password","plug":"input","type":"*","group":"Inputs","index":5},{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":6},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":7},{"name":"out-error","displayName":"error","plug":"output","type":"*","group":"Outputs","index":8}],"children":[],"metadata":{"merge":{"soureCodePorts":["functionScript"]}}},{"id":"90892fe4-f8f3-bda7-783c-7110f804f8be","type":"/Firebase/Firebase - Get Current User","x":-59.752909133381934,"y":-192.60679978599399,"parameters":{},"ports":[],"dynamicports":[],"children":[]},{"id":"a1849f89-cdfe-2b96-ed75-7bdca0101f70","type":"Inverter","x":-8.266941452253434,"y":161.63598761354686,"parameters":{},"ports":[],"dynamicports":[],"children":[]}],"visualRoots":["c908a1dd-ccba-af4d-84cd-e49b4eb7925a"]}}],"settings":{"bodyScroll":true,"navigationPathType":"path","headCode":"<script type=\"module\">\r\n  import { initializeApp } from \"https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js\";\r\n  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, sendEmailVerification, sendPasswordResetEmail, verifyBeforeUpdateEmail, updatePassword, EmailAuthProvider, reauthenticateWithCredential, signOut } from \"https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js\";\r\n  import { getFirestore } from \"https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js\";\r\n  \r\n  // Expose Firebase initialization and auth functions to the global scope\r\n  window.initializeApp = initializeApp;\r\n  window.getAuth = getAuth;\r\n  window.createUserWithEmailAndPassword = createUserWithEmailAndPassword;\r\n  window.signInWithEmailAndPassword = signInWithEmailAndPassword;\r\n  window.onAuthStateChanged = onAuthStateChanged;\r\n  window.sendEmailVerification = sendEmailVerification;\r\n  window.sendPasswordResetEmail = sendPasswordResetEmail;\r\n  window.verifyBeforeUpdateEmail = verifyBeforeUpdateEmail;\r\n  window.updatePassword = updatePassword;\r\n  window.EmailAuthProvider = EmailAuthProvider;\r\n  window.reauthenticateWithCredential = reauthenticateWithCredential;\r\n  window.getFirestore = getFirestore;\r\n</script>\r\n<script src=\"https://cdn.jsdelivr.net/npm/validator/validator.min.js\"></script>\r\n<script>\r\n  window.validator = validator;\r\n</script>"},"rootNodeId":"246f9453-a119-ac78-171e-3806cf596ecc","version":"4","metadata":{"styles":{"text":{"Display":{"letterSpacing":"Auto","lineHeight":{"value":"120","unit":"%"},"textTransform":"none","fontSize":{"value":"40","unit":"px"},"fontFamily":"fonts/Roboto/Roboto-Regular.ttf","color":"#000000"},"Headline":{"fontFamily":"fonts/Roboto/Roboto-Regular.ttf","fontSize":{"value":"32","unit":"px"},"color":"#000000","letterSpacing":"Auto","lineHeight":{"value":"120","unit":"%"},"textTransform":"none"},"Title Large":{"fontFamily":"fonts/Roboto/Roboto-Bold.ttf","fontSize":{"value":"24","unit":"px"},"color":"#000000","letterSpacing":"Auto","lineHeight":{"value":"120%","unit":"px"},"textTransform":"none"},"Title Medium":{"fontFamily":"fonts/Roboto/Roboto-Medium.ttf","fontSize":{"value":"20","unit":"px"},"color":"#000000","letterSpacing":"Auto","lineHeight":{"value":"120","unit":"%"},"textTransform":"none"},"Title Small":{"fontFamily":"fonts/Roboto/Roboto-Bold.ttf","fontSize":{"value":"16","unit":"px"},"color":"#000000","letterSpacing":"Auto","lineHeight":{"value":"120","unit":"%"},"textTransform":"none"},"Label Large":{"fontFamily":"fonts/Roboto/Roboto-Medium.ttf","fontSize":{"value":"16","unit":"px"},"color":"#000000","letterSpacing":"Auto","lineHeight":{"value":"120","unit":"%"},"textTransform":"none"},"Label Medium":{"fontFamily":"fonts/Roboto/Roboto-Medium.ttf","fontSize":{"value":"14","unit":"px"},"color":"#000000","letterSpacing":"Auto","lineHeight":{"value":"120","unit":"%"},"textTransform":"none"},"Label Small":{"fontFamily":"fonts/Roboto/Roboto-Medium.ttf","fontSize":{"value":"12","unit":"px"},"color":"#000000","letterSpacing":"Auto","lineHeight":{"value":"120","unit":"%"},"textTransform":"none"},"Body Large":{"fontFamily":"fonts/Roboto/Roboto-Regular.ttf","fontSize":{"value":"20","unit":"px"},"color":"#000000","letterSpacing":"Auto","lineHeight":{"value":"150","unit":"%"},"textTransform":"none"},"Body Medium":{"fontFamily":"fonts/Roboto/Roboto-Regular.ttf","fontSize":{"value":"16","unit":"px"},"color":"#000000","letterSpacing":"Auto","lineHeight":{"value":"150","unit":"%"},"textTransform":"none"},"Body Small":{"letterSpacing":"Auto","lineHeight":{"value":"150","unit":"%"},"textTransform":"none","fontFamily":"fonts/Roboto/Roboto-Regular.ttf","fontSize":{"value":"14","unit":"px"},"color":"#000000"}},"colors":{"Primary":"#5836F5","Primary Dark":"#3F22B8","Primary Subtle":"#C9BFFC","Primary Light":"#F7F5FF","Grey - 900":"#1F1F1F","Grey - 800":"#383838","Grey - 700":"#4C4C4C","Grey - 600":"#757575","Grey - 500":"#A5A5A5","Grey - 400":"#CECECE","Grey - 300":"#E9E9E9","Grey - 200":"#F4F4F4","Grey - 100":"#FBFBFB","Success":"#49AD7F","Notice":"#F2C441","Danger":"#F75A4F","White":"#FFFFFF","Black":"#000000"}}},"variants":[{"typename":"Text","parameters":{"textStyle":"Body Medium"},"stateParamaters":{},"stateTransitions":{}},{"typename":"net.noodl.controls.button","parameters":{"height":{"value":40,"unit":"px"},"sizeMode":"contentWidth","backgroundColor":"Primary","iconIconSource":{"class":"material-icons","code":"home"},"iconSpacing":{"value":8,"unit":"px"},"borderRadius":{"value":4,"unit":"px"},"textStyle":"Label Medium","paddingTop":{"value":0,"unit":"px"},"paddingLeft":{"value":24,"unit":"px"},"paddingRight":{"value":24,"unit":"px"},"paddingBottom":{"value":0,"unit":"px"},"color":"#FFFFFF","minWidth":{"value":80,"unit":"px"},"useIcon":false,"iconSize":{"value":20,"unit":"px"}},"stateParamaters":{"hover":{"backgroundColor":"Primary Dark"},"pressed":{"backgroundColor":"Primary","color":"White"},"disabled":{"backgroundColor":"Grey - 300","color":"Grey - 600"}},"stateTransitions":{},"defaultStateTransitions":{"neutral":{"curve":[0,0,0.58,1],"dur":0,"delay":0},"hover":{"curve":[0,0,0.58,1],"dur":0,"delay":0},"pressed":{"curve":[0,0,0.58,1],"dur":0,"delay":0}}},{"typename":"net.noodl.controls.textinput","parameters":{"useLabel":true,"sizeMode":"explicit","height":{"value":40,"unit":"px"},"textStyle":"Body Medium","borderStyle":"solid","borderRadius":{"value":4,"unit":"px"},"borderWidth":{"value":1,"unit":"px"},"borderColor":"Grey - 700","labeltextStyle":"Label Small","paddingLeft":{"value":12,"unit":"px"},"paddingRight":{"value":8,"unit":"px"},"labelSpacing":{"value":4,"unit":"px"},"placeholder":"Type here","color":"Grey - 900","placeHolderOpacity":0.65,"enabled":true,"blockTouch":false,"useIcon":false,"iconIconSource":{"class":"material-icons","code":"home"},"iconSize":{"value":20,"unit":"px"},"iconSpacing":{"value":4,"unit":"px"},"iconColor":"Grey - 700","labelcolor":"Grey - 700"},"stateParamaters":{"hover":{"labelcolor":"Grey - 700","borderColor":"Grey - 700","borderStyle":"solid","color":"Grey - 900"},"focused":{"borderColor":"Primary","labelcolor":"Primary","borderWidth":{"value":1,"unit":"px"},"boxShadowEnabled":false,"boxShadowColor":"Primary","borderStyle":"solid"},"disabled":{"labelcolor":"Grey - 500","backgroundColor":"Grey - 200","borderWidth":{"value":1,"unit":"px"},"borderColor":"Grey - 500","color":"Grey - 600"}},"stateTransitions":{},"defaultStateTransitions":{"neutral":{"curve":[0,0,0.58,1],"dur":0,"delay":0},"focused":{"curve":[0,0,0.58,1],"dur":0,"delay":0},"hover":{"curve":[0,0,0.58,1],"dur":0,"delay":0},"disabled":{"curve":[0,0,0.58,1],"dur":0,"delay":0}}},{"typename":"net.noodl.controls.options","parameters":{"sizeMode":"explicit","height":{"value":40,"unit":"px"},"borderWidth":{"value":1,"unit":"px"},"borderRadius":{"value":4,"unit":"px"},"borderColor":"Grey - 700","boxShadowColor":"Dark Gray","useIcon":true,"iconIconSource":{"class":"material-icons","code":"expand_more"},"iconPlacement":"right","iconSize":{"value":20,"unit":"px"},"paddingRight":{"value":12,"unit":"px"},"textStyle":"Body Medium","paddingLeft":{"value":12,"unit":"px"},"marginTop":{"value":0,"unit":"px"},"width":{"value":100,"unit":"%"},"iconColor":"Grey - 700","placeholderOpacity":0.65,"placeholder":"Select option","useLabel":true,"labelSpacing":{"value":4,"unit":"px"},"labeltextStyle":"Label Small","labelcolor":"Grey - 700","items":"[\n    {\"Label\":\"Option 1\", \"Value\":\"1\"},\n    {\"Label\":\"Option 2\", \"Value\":\"2\"},\n    {\"Label\":\"Option 3\", \"Value\":\"3\"}\n]"},"stateParamaters":{"hover":{"borderColor":"Grey - 700","borderRadius":{"value":4,"unit":"px"},"iconColor":"Grey - 900","iconSize":{"value":20,"unit":"px"},"iconPlacement":"right","color":"Grey - 900","labelcolor":"Grey - 700"},"focused":{"borderColor":"Primary","boxShadowColor":"Primary","borderRadius":{"value":4,"unit":"px"},"useIcon":true,"iconColor":"Primary","iconIconSource":{"class":"material-icons","code":"keyboard_arrow_up"},"iconPlacement":"right","color":"Grey - 900","labelcolor":"Primary"},"pressed":{"borderRadius":{"value":4,"unit":"px"}},"disabled":{"labelcolor":"Grey - 500","iconColor":"Grey - 500","borderColor":"Grey - 500","color":"Grey - 600","backgroundColor":"Grey - 200"}},"stateTransitions":{},"defaultStateTransitions":{"neutral":{"curve":[0,0,0.58,1],"dur":0,"delay":0},"focused":{"curve":[0,0,0.58,1],"dur":0,"delay":0},"hover":{"curve":[0,0,0.58,1],"dur":0,"delay":0},"pressed":{"curve":[0,0,0.58,1],"dur":0,"delay":0}}},{"typename":"net.noodl.controls.range","parameters":{"thumbColor":"Primary","thumbBorderRadius":{"value":100,"unit":"%"},"trackHeight":{"value":4,"unit":"px"},"trackActiveColor":"Primary","trackColor":"Primary Subtle","width":{"value":100,"unit":"%"},"trackBorderRadius":{"value":100,"unit":"px"},"thumbHeight":{"value":16,"unit":"px"},"thumbWidth":{"value":16,"unit":"px"}},"stateParamaters":{"hover":{"thumbColor":"Primary Dark","trackActiveColor":"Primary Dark"},"disabled":{"trackActiveColor":"Grey - 500","trackColor":"Grey - 300","thumbColor":"Grey - 500"}},"stateTransitions":{}},{"typename":"net.noodl.controls.checkbox","parameters":{"width":{"value":20,"unit":"px"},"height":{"value":20,"unit":"px"},"useIcon":false,"borderWidth":{"value":1,"unit":"px"},"useLabel":true,"labeltextStyle":"Body Medium","borderRadius":{"value":2,"unit":"px"},"borderColor":"Grey - 700","labelfontSize":{"value":16,"unit":"px"},"labelcolor":"Grey - 900","labelSpacing":{"value":12,"unit":"px"}},"stateParamaters":{"checked":{"useIcon":true,"iconIconSource":{"class":"material-icons","code":"check"},"backgroundColor":"Primary","borderColor":"Primary","iconSize":{"value":16,"unit":"px"}},"disabled":{"opacity":0.5},"hover":{"borderColor":"Grey - 700"},"pressed":{}},"stateTransitions":{},"defaultStateTransitions":{"neutral":{"curve":[0,0,0.58,1],"dur":0,"delay":0},"hover":{"curve":[0,0,0.58,1],"dur":300,"delay":0},"checked":{"curve":[0,0,0.58,1],"dur":0,"delay":0}}},{"typename":"net.noodl.controls.radiobutton","parameters":{"width":{"value":20,"unit":"px"},"height":{"value":20,"unit":"px"},"useLabel":true,"labeltextStyle":"Body Large","borderWidth":{"value":1,"unit":"px"},"value":"0","useIcon":false,"fillColor":"transparent","borderColor":"Grey - 700","labelfontSize":{"value":16,"unit":"px"},"marginBottom":{"value":8,"unit":"px"},"labelcolor":"Grey - 900","labelSpacing":{"value":12,"unit":"px"}},"stateParamaters":{"checked":{"fillColor":"Primary","borderColor":"Primary","borderWidth":{"value":1,"unit":"px"},"backgroundColor":"transparent","width":{"value":20,"unit":"px"},"height":{"value":20,"unit":"px"},"fillSpacing":{"value":2,"unit":"px"}},"hover":{"backgroundColor":"transparent","borderColor":"Grey - 700","width":{"value":20,"unit":"px"},"height":{"value":20,"unit":"px"}},"disabled":{"borderColor":"Grey - 500","labelcolor":"Grey - 500","fillColor":"transparent"}},"stateTransitions":{},"defaultStateTransitions":{"neutral":{"curve":[0,0,0.58,1],"dur":0,"delay":0},"hover":{"curve":[0,0,0.58,1],"dur":0,"delay":0},"checked":{"curve":[0,0,0.58,1],"dur":0,"delay":0}}},{"name":"Text Button","typename":"net.noodl.controls.button","parameters":{"height":{"value":40,"unit":"px"},"sizeMode":"contentSize","backgroundColor":"transparent","iconIconSource":{"class":"material-icons","code":"home"},"iconSpacing":{"value":8,"unit":"px"},"borderRadius":{"value":4,"unit":"px"},"textStyle":"Label Medium","paddingTop":{"value":0,"unit":"px"},"paddingLeft":{"value":0,"unit":"px"},"paddingRight":{"value":0,"unit":"px"},"paddingBottom":{"value":0,"unit":"px"},"color":"Primary","minWidth":{"value":0,"unit":"px"},"useIcon":false,"iconSize":{"value":20,"unit":"px"},"label":"Sign up"},"stateParamaters":{"hover":{"backgroundColor":"Primary Dark"},"pressed":{"backgroundColor":"Primary","color":"White"},"disabled":{"backgroundColor":"Grey - 300","color":"Grey - 600"}},"stateTransitions":{},"defaultStateTransitions":{"neutral":{"curve":[0,0,0.58,1],"dur":0,"delay":0},"hover":{"curve":[0,0,0.58,1],"dur":0,"delay":0},"pressed":{"curve":[0,0,0.58,1],"dur":0,"delay":0}}}]}